"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
self["webpackHotUpdate_N_E"]("pages/dashboard/institution",{

/***/ "./hooks/useInstitution.ts":
/*!*********************************!*\
  !*** ./hooks/useInstitution.ts ***!
  \*********************************/
/***/ (function(module, __webpack_exports__, __webpack_require__) {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   useInstitution: function() { return /* binding */ useInstitution; }\n/* harmony export */ });\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ \"./node_modules/react/index.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _chakra_ui_react__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @chakra-ui/react */ \"./node_modules/@chakra-ui/react/dist/index.mjs\");\n/* harmony import */ var _utils_contracts__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../utils/contracts */ \"./utils/contracts.ts\");\n/* harmony import */ var wagmi__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! wagmi */ \"./node_modules/wagmi/dist/esm/exports/index.js\");\n/* harmony import */ var _useContract__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./useContract */ \"./hooks/useContract.ts\");\n\n\n\n\n\n// Add type for local storage\nconst INSTITUTION_STORAGE_KEY = \"institution_data\";\nconst EXAMS_STORAGE_KEY = \"institution_exams\";\nconst CERTIFICATES_STORAGE_KEY = \"institution_certificates\";\nconst useInstitution = ()=>{\n    const { examManagementContract, certificatesContract, isInitialized: contractsInitialized, isLoading: contractsLoading } = (0,_useContract__WEBPACK_IMPORTED_MODULE_2__.useContract)();\n    const { address = undefined, isConnected = false } = (0,wagmi__WEBPACK_IMPORTED_MODULE_3__.useAccount)() || {};\n    const toast = (0,_chakra_ui_react__WEBPACK_IMPORTED_MODULE_4__.useToast)();\n    const [isLoading, setIsLoading] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(true);\n    const [isInitialized, setIsInitialized] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(false);\n    const [initializationAttempts, setInitializationAttempts] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(0);\n    const [institution, setInstitution] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(null);\n    const [exams, setExams] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)([]);\n    const [certificates, setCertificates] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)([]);\n    const [hasAccess, setHasAccess] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(false);\n    const [selectedExamResults, setSelectedExamResults] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)([]);\n    const [examStatistics, setExamStatistics] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(null);\n    const checkAccess = async (userAddress)=>{\n        console.log(\"[CheckAccess] Starting access check for:\", userAddress);\n        if (!examManagementContract) {\n            console.error(\"[CheckAccess] Contract not initialized\");\n            toast({\n                title: \"Error\",\n                description: \"Contract not initialized. Please try again.\",\n                status: \"error\"\n            });\n            return false;\n        }\n        try {\n            console.log(\"[CheckAccess] Checking if address is institution...\");\n            const isInstitutionResult = await examManagementContract.isInstitution(userAddress);\n            console.log(\"[CheckAccess] isInstitution result:\", isInstitutionResult);\n            if (!isInstitutionResult) {\n                console.log(\"[CheckAccess] Address is not registered as institution\");\n                toast({\n                    title: \"Error\",\n                    description: \"Address is not registered as an institution\",\n                    status: \"error\"\n                });\n                return false;\n            }\n            console.log(\"[CheckAccess] Getting institution data...\");\n            const institutionData = await examManagementContract.getInstitution(userAddress);\n            console.log(\"[CheckAccess] Institution data:\", institutionData);\n            if (!institutionData || institutionData.length < 10) {\n                console.error(\"[CheckAccess] Invalid institution data received\");\n                toast({\n                    title: \"Error\",\n                    description: \"Invalid institution data\",\n                    status: \"error\"\n                });\n                return false;\n            }\n            const isVerified = Boolean(institutionData[9]);\n            console.log(\"[CheckAccess] Institution verification status:\", isVerified);\n            if (!isVerified) {\n                toast({\n                    title: \"Error\",\n                    description: \"Institution is not verified\",\n                    status: \"error\"\n                });\n                return false;\n            }\n            console.log(\"[CheckAccess] Access granted\");\n            return true;\n        } catch (error) {\n            console.error(\"[CheckAccess] Error checking access:\", error);\n            toast({\n                title: \"Error\",\n                description: \"Error checking institution access\",\n                status: \"error\"\n            });\n            return false;\n        }\n    };\n    (0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(()=>{\n        let isMounted = true;\n        let initTimeout;\n        const initializeData = async ()=>{\n            try {\n                console.log(\"Starting initialization check:\", {\n                    isConnected,\n                    hasAddress: !!address,\n                    hasContract: !!examManagementContract,\n                    contractsInitialized,\n                    contractsLoading,\n                    attempts: initializationAttempts\n                });\n                if (!isConnected || !address) {\n                    console.log(\"Not connected or no address\");\n                    if (isMounted) {\n                        setIsLoading(false);\n                        setHasAccess(false);\n                    }\n                    return;\n                }\n                // Wait for contracts to finish loading\n                if (contractsLoading) {\n                    console.log(\"Contracts are still loading...\");\n                    return;\n                }\n                if (!examManagementContract || !certificatesContract || !contractsInitialized) {\n                    console.error(\"Contracts not initialized\");\n                    if (isMounted) {\n                        setIsLoading(false);\n                        setHasAccess(false);\n                        // Retry initialization if under max attempts\n                        if (initializationAttempts < 3) {\n                            initTimeout = setTimeout(()=>{\n                                setInitializationAttempts((prev)=>prev + 1);\n                            }, 1000 * (initializationAttempts + 1));\n                        } else {\n                            // Show error toast after max attempts\n                            toast({\n                                title: \"خطأ في تهيئة العقود | Contract Initialization Error\",\n                                description: \"فشل في تهيئة العقود بعد عدة محاولات | Failed to initialize contracts after several attempts\",\n                                status: \"error\",\n                                duration: 5000,\n                                isClosable: true\n                            });\n                        }\n                    }\n                    return;\n                }\n                // Reset attempts on successful initialization\n                if (initializationAttempts > 0) {\n                    setInitializationAttempts(0);\n                }\n                if (isMounted) {\n                    setIsLoading(true);\n                }\n                // Check access first\n                const accessGranted = await checkAccess(address);\n                console.log(\"Access check result:\", accessGranted);\n                if (!isMounted) return;\n                setHasAccess(accessGranted);\n                if (!accessGranted) {\n                    setIsLoading(false);\n                    return;\n                }\n                // Load data only if access is granted\n                const [institutionData, examsData, certificatesData] = await Promise.all([\n                    loadInstitutionFromContract(address),\n                    loadExamsFromContract(address),\n                    loadCertificatesFromContract(address)\n                ]);\n                if (!isMounted) return;\n                if (institutionData) {\n                    setInstitution(institutionData);\n                    setIsInitialized(true);\n                }\n                if (examsData) {\n                    setExams(examsData);\n                }\n                if (certificatesData) {\n                    setCertificates(certificatesData);\n                }\n            } catch (error) {\n                console.error(\"Critical initialization error:\", {\n                    error: error instanceof Error ? {\n                        name: error.name,\n                        message: error.message,\n                        stack: error.stack\n                    } : \"Unknown error\",\n                    address,\n                    contractStatus: {\n                        hasExamContract: !!examManagementContract,\n                        hasCertificatesContract: !!certificatesContract,\n                        isInitialized: contractsInitialized,\n                        isLoading: contractsLoading\n                    }\n                });\n                if (isMounted) {\n                    toast({\n                        title: \"خطأ في تهيئة البيانات | Initialization Error\",\n                        description: error instanceof Error ? \"\".concat(error.message, \" | حدث خطأ أثناء تحميل البيانات\") : \"حدث خطأ غير معروف | An unknown error occurred\",\n                        status: \"error\",\n                        duration: 5000,\n                        isClosable: true\n                    });\n                    setHasAccess(false);\n                }\n            } finally{\n                if (isMounted) {\n                    setIsLoading(false);\n                }\n            }\n        };\n        initializeData();\n        return ()=>{\n            isMounted = false;\n            if (initTimeout) {\n                clearTimeout(initTimeout);\n            }\n        };\n    }, [\n        isConnected,\n        address,\n        examManagementContract,\n        certificatesContract,\n        contractsInitialized,\n        contractsLoading,\n        initializationAttempts\n    ]);\n    // Helper functions with proper type checking\n    const loadInstitutionFromContract = async (userAddress)=>{\n        if (!examManagementContract || !userAddress) return null;\n        try {\n            const data = await examManagementContract.getInstitution(userAddress);\n            return {\n                name: data.name,\n                ministry: data.ministry,\n                university: data.university,\n                college: data.college,\n                description: data.description,\n                imageUrl: data.imageUrl,\n                website: data.website,\n                email: data.email,\n                phone: data.phone\n            };\n        } catch (error) {\n            console.error(\"Error loading institution:\", error);\n            return null;\n        }\n    };\n    const loadExamsFromContract = async (userAddress)=>{\n        if (!examManagementContract || !userAddress) {\n            return [];\n        }\n        try {\n            return await examManagementContract.getInstitutionExams(userAddress);\n        } catch (error) {\n            console.error(\"Error loading exams:\", error);\n            return [];\n        }\n    };\n    const loadCertificatesFromContract = async (userAddress)=>{\n        if (!certificatesContract || !userAddress) {\n            return [];\n        }\n        try {\n            return await certificatesContract.getInstitutionCertificates(userAddress);\n        } catch (error) {\n            console.error(\"Error loading certificates:\", error);\n            return [];\n        }\n    };\n    const createExam = async (exam)=>{\n        if (!address) {\n            toast({\n                title: \"خطأ في العنوان | Address Error\",\n                description: \"لم يتم العثور على عنوان المحفظة | Wallet address not found\",\n                status: \"error\",\n                duration: 3000\n            });\n            return false;\n        }\n        try {\n            setIsLoading(true);\n            const contract = await (0,_utils_contracts__WEBPACK_IMPORTED_MODULE_1__.getContract)();\n            const tx = await contract.createExam(exam.title, exam.description, exam.date);\n            await tx.wait();\n            await loadExamsFromContract(address);\n            return true;\n        } catch (err) {\n            console.error(\"Error creating exam:\", err);\n            toast({\n                title: \"Error creating exam\",\n                description: err instanceof Error ? err.message : \"An unknown error occurred\",\n                status: \"error\",\n                duration: 3000\n            });\n            return false;\n        } finally{\n            setIsLoading(false);\n        }\n    };\n    const updateExamStatus = async (examId, status)=>{\n        if (!address) {\n            toast({\n                title: \"خطأ في العنوان | Address Error\",\n                description: \"لم يتم العثور على عنوان المحفظة | Wallet address not found\",\n                status: \"error\",\n                duration: 3000\n            });\n            return false;\n        }\n        try {\n            setIsLoading(true);\n            const contract = await (0,_utils_contracts__WEBPACK_IMPORTED_MODULE_1__.getContract)();\n            const tx = await contract.updateExamStatus(examId, status);\n            await tx.wait();\n            await loadExamsFromContract(address);\n            return true;\n        } catch (err) {\n            console.error(\"Error updating exam status:\", err);\n            toast({\n                title: \"Error updating exam status\",\n                description: err instanceof Error ? err.message : \"An unknown error occurred\",\n                status: \"error\",\n                duration: 3000\n            });\n            return false;\n        } finally{\n            setIsLoading(false);\n        }\n    };\n    const registerStudents = async (examId, students)=>{\n        try {\n            setIsLoading(true);\n            const contract = await (0,_utils_contracts__WEBPACK_IMPORTED_MODULE_1__.getContract)();\n            const tx = await contract.registerStudents(examId, students);\n            await tx.wait();\n            return true;\n        } catch (err) {\n            console.error(\"Error registering students:\", err);\n            toast({\n                title: \"Error registering students\",\n                description: err instanceof Error ? err.message : \"An unknown error occurred\",\n                status: \"error\",\n                duration: 3000\n            });\n            return false;\n        } finally{\n            setIsLoading(false);\n        }\n    };\n    const handleSubmitResults = async (examId, results)=>{\n        try {\n            setIsLoading(true);\n            const contract = await (0,_utils_contracts__WEBPACK_IMPORTED_MODULE_1__.getContract)();\n            const tx = await contract.submitResults(examId, results);\n            await tx.wait();\n            await loadExamResults(examId);\n            toast({\n                title: \"تم إضافة النتائج بنجاح | Results submitted successfully\",\n                status: \"success\",\n                duration: 3000\n            });\n            return true;\n        } catch (err) {\n            console.error(\"Error submitting results:\", err);\n            toast({\n                title: \"حدث خطأ | Error occurred\",\n                description: err instanceof Error ? err.message : \"An unknown error occurred\",\n                status: \"error\",\n                duration: 3000\n            });\n            return false;\n        } finally{\n            setIsLoading(false);\n        }\n    };\n    const loadExamResults = async (examId)=>{\n        try {\n            const currentExam = exams.find((exam)=>exam.id === examId);\n            if (!currentExam) {\n                throw new Error(\"Exam not found\");\n            }\n            const examResultsList = await Promise.all(currentExam.students.map(async (studentId)=>{\n                try {\n                    const result = await (0,_utils_contracts__WEBPACK_IMPORTED_MODULE_1__.getExamResult)(examId, studentId);\n                    return result;\n                } catch (e) {\n                    return null;\n                }\n            }));\n            const validResults = examResultsList.filter((result)=>result !== null);\n            setSelectedExamResults(validResults);\n            if (validResults.length === 0) {\n                setExamStatistics(null);\n                return;\n            }\n            // Calculate statistics\n            const totalStudents = validResults.length;\n            const passingStudents = validResults.filter((result)=>result.score >= 60).length;\n            const totalScore = validResults.reduce((sum, result)=>sum + result.score, 0);\n            const gradeCount = {\n                A: validResults.filter((result)=>result.grade === \"A\").length,\n                B: validResults.filter((result)=>result.grade === \"B\").length,\n                C: validResults.filter((result)=>result.grade === \"C\").length,\n                D: validResults.filter((result)=>result.grade === \"D\").length,\n                F: validResults.filter((result)=>result.grade === \"F\").length\n            };\n            const mostCommonGrade = Object.entries(gradeCount).reduce((a, b)=>a[1] > b[1] ? a : b)[0];\n            setExamStatistics({\n                totalStudents,\n                passingCount: passingStudents,\n                aCount: gradeCount.A,\n                bCount: gradeCount.B,\n                cCount: gradeCount.C,\n                dCount: gradeCount.D,\n                fCount: gradeCount.F,\n                averageScore: totalScore / totalStudents,\n                passRate: passingStudents * 100 / totalStudents,\n                mostCommonGrade\n            });\n        } catch (err) {\n            console.error(\"Error loading exam results:\", err);\n            toast({\n                title: \"Error loading results\",\n                description: err instanceof Error ? err.message : \"An unknown error occurred\",\n                status: \"error\",\n                duration: 3000\n            });\n        }\n    };\n    const handleEnrollStudent = async (examId, studentAddress)=>{\n        if (!address) {\n            toast({\n                title: \"خطأ في العنوان | Address Error\",\n                description: \"لم يتم العثور على عنوان المحفظة | Wallet address not found\",\n                status: \"error\",\n                duration: 3000\n            });\n            return false;\n        }\n        try {\n            setIsLoading(true);\n            await (0,_utils_contracts__WEBPACK_IMPORTED_MODULE_1__.enrollStudent)(examId, studentAddress);\n            toast({\n                title: \"Student enrolled successfully\",\n                status: \"success\",\n                duration: 3000\n            });\n            await loadExamsFromContract(address);\n            return true;\n        } catch (err) {\n            console.error(\"Error enrolling student:\", err);\n            toast({\n                title: \"Error enrolling student\",\n                description: err instanceof Error ? err.message : \"An unknown error occurred\",\n                status: \"error\",\n                duration: 3000\n            });\n            return false;\n        } finally{\n            setIsLoading(false);\n        }\n    };\n    const issueCertificate = async (studentAddress, certificate)=>{\n        if (!address) {\n            toast({\n                title: \"خطأ في العنوان | Address Error\",\n                description: \"لم يتم العثور على عنوان المحفظة | Wallet address not found\",\n                status: \"error\",\n                duration: 3000\n            });\n            return false;\n        }\n        try {\n            setIsLoading(true);\n            const contract = await (0,_utils_contracts__WEBPACK_IMPORTED_MODULE_1__.getContract)();\n            const tx = await contract.issueCertificate(studentAddress, certificate.title, certificate.description);\n            await tx.wait();\n            await loadCertificatesFromContract(address);\n            toast({\n                title: \"Certificate issued successfully\",\n                status: \"success\",\n                duration: 3000\n            });\n            return true;\n        } catch (err) {\n            console.error(\"Error issuing certificate:\", err);\n            toast({\n                title: \"Error issuing certificate\",\n                description: err instanceof Error ? err.message : \"An unknown error occurred\",\n                status: \"error\",\n                duration: 3000\n            });\n            return false;\n        } finally{\n            setIsLoading(false);\n        }\n    };\n    const saveInstitutionProfile = async (data)=>{\n        if (!examManagementContract || !address) {\n            throw new Error(\"Contract or address not available\");\n        }\n        // Validate required fields\n        if (!data.name || !data.ministry || !data.university || !data.college || !data.description || !data.imageUrl || !data.website || !data.email || !data.phone) {\n            throw new Error(\"جميع الحقول مطلوبة | All fields are required\");\n        }\n        try {\n            setIsLoading(true);\n            const tx = await examManagementContract.write.updateInstitutionProfile({\n                args: [\n                    data.name,\n                    data.ministry,\n                    data.university,\n                    data.college,\n                    data.description,\n                    data.imageUrl || \"\",\n                    data.website || \"\",\n                    data.email || \"\",\n                    data.phone || \"\"\n                ]\n            });\n            await tx.wait();\n            setInstitution(data);\n            toast({\n                title: \"تم الحفظ بنجاح | Saved Successfully\",\n                status: \"success\",\n                duration: 3000,\n                isClosable: true\n            });\n        } catch (error) {\n            console.error(\"Error saving institution profile:\", error);\n            toast({\n                title: \"خطأ في الحفظ | Error Saving\",\n                description: error instanceof Error ? error.message : \"An unknown error occurred\",\n                status: \"error\",\n                duration: 5000,\n                isClosable: true\n            });\n            throw error;\n        } finally{\n            setIsLoading(false);\n        }\n    };\n    return {\n        institution,\n        exams,\n        certificates,\n        isLoading,\n        isInitialized,\n        hasAccess,\n        selectedExamResults,\n        examStatistics,\n        saveInstitutionProfile,\n        createExam,\n        updateExamStatus,\n        registerStudents,\n        handleSubmitResults,\n        handleEnrollStudent,\n        loadExamResults,\n        issueCertificate\n    };\n};\n\n\n;\n    // Wrapped in an IIFE to avoid polluting the global scope\n    ;\n    (function () {\n        var _a, _b;\n        // Legacy CSS implementations will `eval` browser code in a Node.js context\n        // to extract CSS. For backwards compatibility, we need to check we're in a\n        // browser context before continuing.\n        if (typeof self !== 'undefined' &&\n            // AMP / No-JS mode does not inject these helpers:\n            '$RefreshHelpers$' in self) {\n            // @ts-ignore __webpack_module__ is global\n            var currentExports = module.exports;\n            // @ts-ignore __webpack_module__ is global\n            var prevSignature = (_b = (_a = module.hot.data) === null || _a === void 0 ? void 0 : _a.prevSignature) !== null && _b !== void 0 ? _b : null;\n            // This cannot happen in MainTemplate because the exports mismatch between\n            // templating and execution.\n            self.$RefreshHelpers$.registerExportsForReactRefresh(currentExports, module.id);\n            // A module can be accepted automatically based on its exports, e.g. when\n            // it is a Refresh Boundary.\n            if (self.$RefreshHelpers$.isReactRefreshBoundary(currentExports)) {\n                // Save the previous exports signature on update so we can compare the boundary\n                // signatures. We avoid saving exports themselves since it causes memory leaks (https://github.com/vercel/next.js/pull/53797)\n                module.hot.dispose(function (data) {\n                    data.prevSignature =\n                        self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports);\n                });\n                // Unconditionally accept an update to this module, we'll check if it's\n                // still a Refresh Boundary later.\n                // @ts-ignore importMeta is replaced in the loader\n                module.hot.accept();\n                // This field is set when the previous version of this module was a\n                // Refresh Boundary, letting us know we need to check for invalidation or\n                // enqueue an update.\n                if (prevSignature !== null) {\n                    // A boundary can become ineligible if its exports are incompatible\n                    // with the previous exports.\n                    //\n                    // For example, if you add/remove/change exports, we'll want to\n                    // re-execute the importing modules, and force those components to\n                    // re-render. Similarly, if you convert a class component to a\n                    // function, we want to invalidate the boundary.\n                    if (self.$RefreshHelpers$.shouldInvalidateReactRefreshBoundary(prevSignature, self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports))) {\n                        module.hot.invalidate();\n                    }\n                    else {\n                        self.$RefreshHelpers$.scheduleUpdate();\n                    }\n                }\n            }\n            else {\n                // Since we just executed the code for the module, it's possible that the\n                // new exports made it ineligible for being a boundary.\n                // We only care about the case when we were _previously_ a boundary,\n                // because we already accepted this update (accidental side effect).\n                var isNoLongerABoundary = prevSignature !== null;\n                if (isNoLongerABoundary) {\n                    module.hot.invalidate();\n                }\n            }\n        }\n    })();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ob29rcy91c2VJbnN0aXR1dGlvbi50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7O0FBQXlEO0FBQ2I7QUFjaEI7QUFHTztBQUNTO0FBRzVDLDZCQUE2QjtBQUM3QixNQUFNUSwwQkFBMEI7QUFDaEMsTUFBTUMsb0JBQW9CO0FBQzFCLE1BQU1DLDJCQUEyQjtBQUUxQixNQUFNQyxpQkFBaUI7SUFDNUIsTUFBTSxFQUNKQyxzQkFBc0IsRUFDdEJDLG9CQUFvQixFQUNwQkMsZUFBZUMsb0JBQW9CLEVBQ25DQyxXQUFXQyxnQkFBZ0IsRUFDNUIsR0FBR1YseURBQVdBO0lBQ2YsTUFBTSxFQUFFVyxVQUFVQyxTQUFTLEVBQUVDLGNBQWMsS0FBSyxFQUFFLEdBQUdkLGlEQUFVQSxNQUFNLENBQUM7SUFDdEUsTUFBTWUsUUFBUW5CLDBEQUFRQTtJQUV0QixNQUFNLENBQUNjLFdBQVdNLGFBQWEsR0FBR3RCLCtDQUFRQSxDQUFDO0lBQzNDLE1BQU0sQ0FBQ2MsZUFBZVMsaUJBQWlCLEdBQUd2QiwrQ0FBUUEsQ0FBQztJQUNuRCxNQUFNLENBQUN3Qix3QkFBd0JDLDBCQUEwQixHQUFHekIsK0NBQVFBLENBQUM7SUFDckUsTUFBTSxDQUFDMEIsYUFBYUMsZUFBZSxHQUFHM0IsK0NBQVFBLENBQXlCO0lBQ3ZFLE1BQU0sQ0FBQzRCLE9BQU9DLFNBQVMsR0FBRzdCLCtDQUFRQSxDQUFTLEVBQUU7SUFDN0MsTUFBTSxDQUFDOEIsY0FBY0MsZ0JBQWdCLEdBQUcvQiwrQ0FBUUEsQ0FBZ0IsRUFBRTtJQUNsRSxNQUFNLENBQUNnQyxXQUFXQyxhQUFhLEdBQUdqQywrQ0FBUUEsQ0FBQztJQUMzQyxNQUFNLENBQUNrQyxxQkFBcUJDLHVCQUF1QixHQUFHbkMsK0NBQVFBLENBQWUsRUFBRTtJQUMvRSxNQUFNLENBQUNvQyxnQkFBZ0JDLGtCQUFrQixHQUFHckMsK0NBQVFBLENBQXdCO0lBRTVFLE1BQU1zQyxjQUFjLE9BQU9DO1FBQ3pCQyxRQUFRQyxHQUFHLENBQUMsNENBQTRDRjtRQUV4RCxJQUFJLENBQUMzQix3QkFBd0I7WUFDM0I0QixRQUFRRSxLQUFLLENBQUM7WUFDZHJCLE1BQU07Z0JBQ0pzQixPQUFPO2dCQUNQQyxhQUFhO2dCQUNiQyxRQUFRO1lBQ1Y7WUFDQSxPQUFPO1FBQ1Q7UUFFQSxJQUFJO1lBQ0ZMLFFBQVFDLEdBQUcsQ0FBQztZQUNaLE1BQU1LLHNCQUFzQixNQUFNbEMsdUJBQXVCbUMsYUFBYSxDQUFDUjtZQUN2RUMsUUFBUUMsR0FBRyxDQUFDLHVDQUF1Q0s7WUFFbkQsSUFBSSxDQUFDQSxxQkFBcUI7Z0JBQ3hCTixRQUFRQyxHQUFHLENBQUM7Z0JBQ1pwQixNQUFNO29CQUNKc0IsT0FBTztvQkFDUEMsYUFBYTtvQkFDYkMsUUFBUTtnQkFDVjtnQkFDQSxPQUFPO1lBQ1Q7WUFFQUwsUUFBUUMsR0FBRyxDQUFDO1lBQ1osTUFBTU8sa0JBQWtCLE1BQU1wQyx1QkFBdUJxQyxjQUFjLENBQUNWO1lBQ3BFQyxRQUFRQyxHQUFHLENBQUMsbUNBQW1DTztZQUUvQyxJQUFJLENBQUNBLG1CQUFtQkEsZ0JBQWdCRSxNQUFNLEdBQUcsSUFBSTtnQkFDbkRWLFFBQVFFLEtBQUssQ0FBQztnQkFDZHJCLE1BQU07b0JBQ0pzQixPQUFPO29CQUNQQyxhQUFhO29CQUNiQyxRQUFRO2dCQUNWO2dCQUNBLE9BQU87WUFDVDtZQUVBLE1BQU1NLGFBQWFDLFFBQVFKLGVBQWUsQ0FBQyxFQUFFO1lBQzdDUixRQUFRQyxHQUFHLENBQUMsa0RBQWtEVTtZQUU5RCxJQUFJLENBQUNBLFlBQVk7Z0JBQ2Y5QixNQUFNO29CQUNKc0IsT0FBTztvQkFDUEMsYUFBYTtvQkFDYkMsUUFBUTtnQkFDVjtnQkFDQSxPQUFPO1lBQ1Q7WUFFQUwsUUFBUUMsR0FBRyxDQUFDO1lBQ1osT0FBTztRQUNULEVBQUUsT0FBT0MsT0FBTztZQUNkRixRQUFRRSxLQUFLLENBQUMsd0NBQXdDQTtZQUN0RHJCLE1BQU07Z0JBQ0pzQixPQUFPO2dCQUNQQyxhQUFhO2dCQUNiQyxRQUFRO1lBQ1Y7WUFDQSxPQUFPO1FBQ1Q7SUFDRjtJQUVBNUMsZ0RBQVNBLENBQUM7UUFDUixJQUFJb0QsWUFBWTtRQUNoQixJQUFJQztRQUVKLE1BQU1DLGlCQUFpQjtZQUNyQixJQUFJO2dCQUNGZixRQUFRQyxHQUFHLENBQUMsa0NBQWtDO29CQUM1Q3JCO29CQUNBb0MsWUFBWSxDQUFDLENBQUN0QztvQkFDZHVDLGFBQWEsQ0FBQyxDQUFDN0M7b0JBQ2ZHO29CQUNBRTtvQkFDQXlDLFVBQVVsQztnQkFDWjtnQkFFQSxJQUFJLENBQUNKLGVBQWUsQ0FBQ0YsU0FBUztvQkFDNUJzQixRQUFRQyxHQUFHLENBQUM7b0JBQ1osSUFBSVksV0FBVzt3QkFDYi9CLGFBQWE7d0JBQ2JXLGFBQWE7b0JBQ2Y7b0JBQ0E7Z0JBQ0Y7Z0JBRUEsdUNBQXVDO2dCQUN2QyxJQUFJaEIsa0JBQWtCO29CQUNwQnVCLFFBQVFDLEdBQUcsQ0FBQztvQkFDWjtnQkFDRjtnQkFFQSxJQUFJLENBQUM3QiwwQkFBMEIsQ0FBQ0Msd0JBQXdCLENBQUNFLHNCQUFzQjtvQkFDN0V5QixRQUFRRSxLQUFLLENBQUM7b0JBQ2QsSUFBSVcsV0FBVzt3QkFDYi9CLGFBQWE7d0JBQ2JXLGFBQWE7d0JBRWIsNkNBQTZDO3dCQUM3QyxJQUFJVCx5QkFBeUIsR0FBRzs0QkFDOUI4QixjQUFjSyxXQUFXO2dDQUN2QmxDLDBCQUEwQm1DLENBQUFBLE9BQVFBLE9BQU87NEJBQzNDLEdBQUcsT0FBUXBDLENBQUFBLHlCQUF5Qjt3QkFDdEMsT0FBTzs0QkFDTCxzQ0FBc0M7NEJBQ3RDSCxNQUFNO2dDQUNKc0IsT0FBTztnQ0FDUEMsYUFBYTtnQ0FDYkMsUUFBUTtnQ0FDUmdCLFVBQVU7Z0NBQ1ZDLFlBQVk7NEJBQ2Q7d0JBQ0Y7b0JBQ0Y7b0JBQ0E7Z0JBQ0Y7Z0JBRUEsOENBQThDO2dCQUM5QyxJQUFJdEMseUJBQXlCLEdBQUc7b0JBQzlCQywwQkFBMEI7Z0JBQzVCO2dCQUVBLElBQUk0QixXQUFXO29CQUNiL0IsYUFBYTtnQkFDZjtnQkFFQSxxQkFBcUI7Z0JBQ3JCLE1BQU15QyxnQkFBZ0IsTUFBTXpCLFlBQVlwQjtnQkFDeENzQixRQUFRQyxHQUFHLENBQUMsd0JBQXdCc0I7Z0JBRXBDLElBQUksQ0FBQ1YsV0FBVztnQkFFaEJwQixhQUFhOEI7Z0JBRWIsSUFBSSxDQUFDQSxlQUFlO29CQUNsQnpDLGFBQWE7b0JBQ2I7Z0JBQ0Y7Z0JBRUEsc0NBQXNDO2dCQUN0QyxNQUFNLENBQUMwQixpQkFBaUJnQixXQUFXQyxpQkFBaUIsR0FBRyxNQUFNQyxRQUFRQyxHQUFHLENBQUM7b0JBQ3ZFQyw0QkFBNEJsRDtvQkFDNUJtRCxzQkFBc0JuRDtvQkFDdEJvRCw2QkFBNkJwRDtpQkFDOUI7Z0JBRUQsSUFBSSxDQUFDbUMsV0FBVztnQkFFaEIsSUFBSUwsaUJBQWlCO29CQUNuQnJCLGVBQWVxQjtvQkFDZnpCLGlCQUFpQjtnQkFDbkI7Z0JBRUEsSUFBSXlDLFdBQVc7b0JBQ2JuQyxTQUFTbUM7Z0JBQ1g7Z0JBRUEsSUFBSUMsa0JBQWtCO29CQUNwQmxDLGdCQUFnQmtDO2dCQUNsQjtZQUVGLEVBQUUsT0FBT3ZCLE9BQU87Z0JBQ2RGLFFBQVFFLEtBQUssQ0FBQyxrQ0FBa0M7b0JBQzlDQSxPQUFPQSxpQkFBaUI2QixRQUFRO3dCQUM5QkMsTUFBTTlCLE1BQU04QixJQUFJO3dCQUNoQkMsU0FBUy9CLE1BQU0rQixPQUFPO3dCQUN0QkMsT0FBT2hDLE1BQU1nQyxLQUFLO29CQUNwQixJQUFJO29CQUNKeEQ7b0JBQ0F5RCxnQkFBZ0I7d0JBQ2RDLGlCQUFpQixDQUFDLENBQUNoRTt3QkFDbkJpRSx5QkFBeUIsQ0FBQyxDQUFDaEU7d0JBQzNCQyxlQUFlQzt3QkFDZkMsV0FBV0M7b0JBQ2I7Z0JBQ0Y7Z0JBRUEsSUFBSW9DLFdBQVc7b0JBQ2JoQyxNQUFNO3dCQUNKc0IsT0FBTzt3QkFDUEMsYUFBYUYsaUJBQWlCNkIsUUFDMUIsR0FBaUIsT0FBZDdCLE1BQU0rQixPQUFPLEVBQUMscUNBQ2pCO3dCQUNKNUIsUUFBUTt3QkFDUmdCLFVBQVU7d0JBQ1ZDLFlBQVk7b0JBQ2Q7b0JBRUE3QixhQUFhO2dCQUNmO1lBQ0YsU0FBVTtnQkFDUixJQUFJb0IsV0FBVztvQkFDYi9CLGFBQWE7Z0JBQ2Y7WUFDRjtRQUNGO1FBRUFpQztRQUVBLE9BQU87WUFDTEYsWUFBWTtZQUNaLElBQUlDLGFBQWE7Z0JBQ2Z3QixhQUFheEI7WUFDZjtRQUNGO0lBQ0YsR0FBRztRQUNEbEM7UUFDQUY7UUFDQU47UUFDQUM7UUFDQUU7UUFDQUU7UUFDQU87S0FDRDtJQUVELDZDQUE2QztJQUM3QyxNQUFNNEMsOEJBQThCLE9BQU83QjtRQUN6QyxJQUFJLENBQUMzQiwwQkFBMEIsQ0FBQzJCLGFBQWEsT0FBTztRQUVwRCxJQUFJO1lBQ0YsTUFBTXdDLE9BQU8sTUFBTW5FLHVCQUF1QnFDLGNBQWMsQ0FBQ1Y7WUFDekQsT0FBTztnQkFDTGlDLE1BQU1PLEtBQUtQLElBQUk7Z0JBQ2ZRLFVBQVVELEtBQUtDLFFBQVE7Z0JBQ3ZCQyxZQUFZRixLQUFLRSxVQUFVO2dCQUMzQkMsU0FBU0gsS0FBS0csT0FBTztnQkFDckJ0QyxhQUFhbUMsS0FBS25DLFdBQVc7Z0JBQzdCdUMsVUFBVUosS0FBS0ksUUFBUTtnQkFDdkJDLFNBQVNMLEtBQUtLLE9BQU87Z0JBQ3JCQyxPQUFPTixLQUFLTSxLQUFLO2dCQUNqQkMsT0FBT1AsS0FBS08sS0FBSztZQUNuQjtRQUNGLEVBQUUsT0FBTzVDLE9BQU87WUFDZEYsUUFBUUUsS0FBSyxDQUFDLDhCQUE4QkE7WUFDNUMsT0FBTztRQUNUO0lBQ0Y7SUFFQSxNQUFNMkIsd0JBQXdCLE9BQU85QjtRQUNuQyxJQUFJLENBQUMzQiwwQkFBMEIsQ0FBQzJCLGFBQWE7WUFDM0MsT0FBTyxFQUFFO1FBQ1g7UUFFQSxJQUFJO1lBQ0YsT0FBTyxNQUFNM0IsdUJBQXVCMkUsbUJBQW1CLENBQUNoRDtRQUMxRCxFQUFFLE9BQU9HLE9BQU87WUFDZEYsUUFBUUUsS0FBSyxDQUFDLHdCQUF3QkE7WUFDdEMsT0FBTyxFQUFFO1FBQ1g7SUFDRjtJQUVBLE1BQU00QiwrQkFBK0IsT0FBTy9CO1FBQzFDLElBQUksQ0FBQzFCLHdCQUF3QixDQUFDMEIsYUFBYTtZQUN6QyxPQUFPLEVBQUU7UUFDWDtRQUVBLElBQUk7WUFDRixPQUFPLE1BQU0xQixxQkFBcUIyRSwwQkFBMEIsQ0FBQ2pEO1FBQy9ELEVBQUUsT0FBT0csT0FBTztZQUNkRixRQUFRRSxLQUFLLENBQUMsK0JBQStCQTtZQUM3QyxPQUFPLEVBQUU7UUFDWDtJQUNGO0lBRUEsTUFBTStDLGFBQWEsT0FBT0M7UUFDeEIsSUFBSSxDQUFDeEUsU0FBUztZQUNaRyxNQUFNO2dCQUNKc0IsT0FBTztnQkFDUEMsYUFBYTtnQkFDYkMsUUFBUTtnQkFDUmdCLFVBQVU7WUFDWjtZQUNBLE9BQU87UUFDVDtRQUVBLElBQUk7WUFDRnZDLGFBQWE7WUFDYixNQUFNcUUsV0FBVyxNQUFNdEYsNkRBQVdBO1lBQ2xDLE1BQU11RixLQUFLLE1BQU1ELFNBQVNGLFVBQVUsQ0FBQ0MsS0FBSy9DLEtBQUssRUFBRStDLEtBQUs5QyxXQUFXLEVBQUU4QyxLQUFLRyxJQUFJO1lBQzVFLE1BQU1ELEdBQUdFLElBQUk7WUFDYixNQUFNekIsc0JBQXNCbkQ7WUFDNUIsT0FBTztRQUNULEVBQUUsT0FBTzZFLEtBQVU7WUFDakJ2RCxRQUFRRSxLQUFLLENBQUMsd0JBQXdCcUQ7WUFDdEMxRSxNQUFNO2dCQUNKc0IsT0FBTztnQkFDUEMsYUFBYW1ELGVBQWV4QixRQUFRd0IsSUFBSXRCLE9BQU8sR0FBRztnQkFDbEQ1QixRQUFRO2dCQUNSZ0IsVUFBVTtZQUNaO1lBQ0EsT0FBTztRQUNULFNBQVU7WUFDUnZDLGFBQWE7UUFDZjtJQUNGO0lBRUEsTUFBTTBFLG1CQUFtQixPQUFPQyxRQUFnQnBEO1FBQzlDLElBQUksQ0FBQzNCLFNBQVM7WUFDWkcsTUFBTTtnQkFDSnNCLE9BQU87Z0JBQ1BDLGFBQWE7Z0JBQ2JDLFFBQVE7Z0JBQ1JnQixVQUFVO1lBQ1o7WUFDQSxPQUFPO1FBQ1Q7UUFFQSxJQUFJO1lBQ0Z2QyxhQUFhO1lBQ2IsTUFBTXFFLFdBQVcsTUFBTXRGLDZEQUFXQTtZQUNsQyxNQUFNdUYsS0FBSyxNQUFNRCxTQUFTSyxnQkFBZ0IsQ0FBQ0MsUUFBUXBEO1lBQ25ELE1BQU0rQyxHQUFHRSxJQUFJO1lBQ2IsTUFBTXpCLHNCQUFzQm5EO1lBQzVCLE9BQU87UUFDVCxFQUFFLE9BQU82RSxLQUFVO1lBQ2pCdkQsUUFBUUUsS0FBSyxDQUFDLCtCQUErQnFEO1lBQzdDMUUsTUFBTTtnQkFDSnNCLE9BQU87Z0JBQ1BDLGFBQWFtRCxlQUFleEIsUUFBUXdCLElBQUl0QixPQUFPLEdBQUc7Z0JBQ2xENUIsUUFBUTtnQkFDUmdCLFVBQVU7WUFDWjtZQUNBLE9BQU87UUFDVCxTQUFVO1lBQ1J2QyxhQUFhO1FBQ2Y7SUFDRjtJQUVBLE1BQU00RSxtQkFBbUIsT0FBT0QsUUFBZ0JFO1FBQzlDLElBQUk7WUFDRjdFLGFBQWE7WUFDYixNQUFNcUUsV0FBVyxNQUFNdEYsNkRBQVdBO1lBQ2xDLE1BQU11RixLQUFLLE1BQU1ELFNBQVNPLGdCQUFnQixDQUFDRCxRQUFRRTtZQUNuRCxNQUFNUCxHQUFHRSxJQUFJO1lBQ2IsT0FBTztRQUNULEVBQUUsT0FBT0MsS0FBVTtZQUNqQnZELFFBQVFFLEtBQUssQ0FBQywrQkFBK0JxRDtZQUM3QzFFLE1BQU07Z0JBQ0pzQixPQUFPO2dCQUNQQyxhQUFhbUQsZUFBZXhCLFFBQVF3QixJQUFJdEIsT0FBTyxHQUFHO2dCQUNsRDVCLFFBQVE7Z0JBQ1JnQixVQUFVO1lBQ1o7WUFDQSxPQUFPO1FBQ1QsU0FBVTtZQUNSdkMsYUFBYTtRQUNmO0lBQ0Y7SUFFQSxNQUFNOEUsc0JBQXNCLE9BQU9ILFFBQWdCSTtRQUNqRCxJQUFJO1lBQ0YvRSxhQUFhO1lBQ2IsTUFBTXFFLFdBQVcsTUFBTXRGLDZEQUFXQTtZQUNsQyxNQUFNdUYsS0FBSyxNQUFNRCxTQUFTVyxhQUFhLENBQUNMLFFBQVFJO1lBQ2hELE1BQU1ULEdBQUdFLElBQUk7WUFDYixNQUFNUyxnQkFBZ0JOO1lBQ3RCNUUsTUFBTTtnQkFDSnNCLE9BQU87Z0JBQ1BFLFFBQVE7Z0JBQ1JnQixVQUFVO1lBQ1o7WUFDQSxPQUFPO1FBQ1QsRUFBRSxPQUFPa0MsS0FBYztZQUNyQnZELFFBQVFFLEtBQUssQ0FBQyw2QkFBNkJxRDtZQUMzQzFFLE1BQU07Z0JBQ0pzQixPQUFPO2dCQUNQQyxhQUFhbUQsZUFBZXhCLFFBQVF3QixJQUFJdEIsT0FBTyxHQUFHO2dCQUNsRDVCLFFBQVE7Z0JBQ1JnQixVQUFVO1lBQ1o7WUFDQSxPQUFPO1FBQ1QsU0FBVTtZQUNSdkMsYUFBYTtRQUNmO0lBQ0Y7SUFFQSxNQUFNaUYsa0JBQWtCLE9BQU9OO1FBQzdCLElBQUk7WUFDRixNQUFNTyxjQUFjNUUsTUFBTTZFLElBQUksQ0FBQ2YsQ0FBQUEsT0FBUUEsS0FBS2dCLEVBQUUsS0FBS1Q7WUFDbkQsSUFBSSxDQUFDTyxhQUFhO2dCQUNoQixNQUFNLElBQUlqQyxNQUFNO1lBQ2xCO1lBRUEsTUFBTW9DLGtCQUFrQixNQUFNekMsUUFBUUMsR0FBRyxDQUN2Q3FDLFlBQVlMLFFBQVEsQ0FBQ1MsR0FBRyxDQUFDLE9BQU9DO2dCQUM5QixJQUFJO29CQUNGLE1BQU1DLFNBQVMsTUFBTTNHLCtEQUFhQSxDQUFDOEYsUUFBUVk7b0JBQzNDLE9BQU9DO2dCQUNULEVBQUUsVUFBTTtvQkFDTixPQUFPO2dCQUNUO1lBQ0Y7WUFHRixNQUFNQyxlQUFlSixnQkFBZ0JLLE1BQU0sQ0FBQyxDQUFDRixTQUFpQ0EsV0FBVztZQUN6RjNFLHVCQUF1QjRFO1lBRXZCLElBQUlBLGFBQWE3RCxNQUFNLEtBQUssR0FBRztnQkFDN0JiLGtCQUFrQjtnQkFDbEI7WUFDRjtZQUVBLHVCQUF1QjtZQUN2QixNQUFNNEUsZ0JBQWdCRixhQUFhN0QsTUFBTTtZQUN6QyxNQUFNZ0Usa0JBQWtCSCxhQUFhQyxNQUFNLENBQUNGLENBQUFBLFNBQVVBLE9BQU9LLEtBQUssSUFBSSxJQUFJakUsTUFBTTtZQUNoRixNQUFNa0UsYUFBYUwsYUFBYU0sTUFBTSxDQUFDLENBQUNDLEtBQUtSLFNBQVdRLE1BQU1SLE9BQU9LLEtBQUssRUFBRTtZQUU1RSxNQUFNSSxhQUFhO2dCQUNqQkMsR0FBR1QsYUFBYUMsTUFBTSxDQUFDRixDQUFBQSxTQUFVQSxPQUFPVyxLQUFLLEtBQUssS0FBS3ZFLE1BQU07Z0JBQzdEd0UsR0FBR1gsYUFBYUMsTUFBTSxDQUFDRixDQUFBQSxTQUFVQSxPQUFPVyxLQUFLLEtBQUssS0FBS3ZFLE1BQU07Z0JBQzdEeUUsR0FBR1osYUFBYUMsTUFBTSxDQUFDRixDQUFBQSxTQUFVQSxPQUFPVyxLQUFLLEtBQUssS0FBS3ZFLE1BQU07Z0JBQzdEMEUsR0FBR2IsYUFBYUMsTUFBTSxDQUFDRixDQUFBQSxTQUFVQSxPQUFPVyxLQUFLLEtBQUssS0FBS3ZFLE1BQU07Z0JBQzdEMkUsR0FBR2QsYUFBYUMsTUFBTSxDQUFDRixDQUFBQSxTQUFVQSxPQUFPVyxLQUFLLEtBQUssS0FBS3ZFLE1BQU07WUFDL0Q7WUFFQSxNQUFNNEUsa0JBQWtCQyxPQUFPQyxPQUFPLENBQUNULFlBQ3BDRixNQUFNLENBQUMsQ0FBQ1ksR0FBR0MsSUFBTUQsQ0FBQyxDQUFDLEVBQUUsR0FBR0MsQ0FBQyxDQUFDLEVBQUUsR0FBR0QsSUFBSUMsRUFBRSxDQUFDLEVBQUU7WUFFM0M3RixrQkFBa0I7Z0JBQ2hCNEU7Z0JBQ0FrQixjQUFjakI7Z0JBQ2RrQixRQUFRYixXQUFXQyxDQUFDO2dCQUNwQmEsUUFBUWQsV0FBV0csQ0FBQztnQkFDcEJZLFFBQVFmLFdBQVdJLENBQUM7Z0JBQ3BCWSxRQUFRaEIsV0FBV0ssQ0FBQztnQkFDcEJZLFFBQVFqQixXQUFXTSxDQUFDO2dCQUNwQlksY0FBY3JCLGFBQWFIO2dCQUMzQnlCLFVBQVUsa0JBQW1CLE1BQU96QjtnQkFDcENhO1lBQ0Y7UUFDRixFQUFFLE9BQU8vQixLQUFjO1lBQ3JCdkQsUUFBUUUsS0FBSyxDQUFDLCtCQUErQnFEO1lBQzdDMUUsTUFBTTtnQkFDSnNCLE9BQU87Z0JBQ1BDLGFBQWFtRCxlQUFleEIsUUFBUXdCLElBQUl0QixPQUFPLEdBQUc7Z0JBQ2xENUIsUUFBUTtnQkFDUmdCLFVBQVU7WUFDWjtRQUNGO0lBQ0Y7SUFFQSxNQUFNOEUsc0JBQXNCLE9BQU8xQyxRQUFnQjJDO1FBQ2pELElBQUksQ0FBQzFILFNBQVM7WUFDWkcsTUFBTTtnQkFDSnNCLE9BQU87Z0JBQ1BDLGFBQWE7Z0JBQ2JDLFFBQVE7Z0JBQ1JnQixVQUFVO1lBQ1o7WUFDQSxPQUFPO1FBQ1Q7UUFFQSxJQUFJO1lBQ0Z2QyxhQUFhO1lBQ2IsTUFBTWxCLCtEQUFhQSxDQUFDNkYsUUFBUTJDO1lBQzVCdkgsTUFBTTtnQkFDSnNCLE9BQU87Z0JBQ1BFLFFBQVE7Z0JBQ1JnQixVQUFVO1lBQ1o7WUFDQSxNQUFNUSxzQkFBc0JuRDtZQUM1QixPQUFPO1FBQ1QsRUFBRSxPQUFPNkUsS0FBYztZQUNyQnZELFFBQVFFLEtBQUssQ0FBQyw0QkFBNEJxRDtZQUMxQzFFLE1BQU07Z0JBQ0pzQixPQUFPO2dCQUNQQyxhQUFhbUQsZUFBZXhCLFFBQVF3QixJQUFJdEIsT0FBTyxHQUFHO2dCQUNsRDVCLFFBQVE7Z0JBQ1JnQixVQUFVO1lBQ1o7WUFDQSxPQUFPO1FBQ1QsU0FBVTtZQUNSdkMsYUFBYTtRQUNmO0lBQ0Y7SUFFQSxNQUFNdUgsbUJBQW1CLE9BQU9ELGdCQUF3QkU7UUFDdEQsSUFBSSxDQUFDNUgsU0FBUztZQUNaRyxNQUFNO2dCQUNKc0IsT0FBTztnQkFDUEMsYUFBYTtnQkFDYkMsUUFBUTtnQkFDUmdCLFVBQVU7WUFDWjtZQUNBLE9BQU87UUFDVDtRQUVBLElBQUk7WUFDRnZDLGFBQWE7WUFDYixNQUFNcUUsV0FBVyxNQUFNdEYsNkRBQVdBO1lBQ2xDLE1BQU11RixLQUFLLE1BQU1ELFNBQVNrRCxnQkFBZ0IsQ0FBQ0QsZ0JBQWdCRSxZQUFZbkcsS0FBSyxFQUFFbUcsWUFBWWxHLFdBQVc7WUFDckcsTUFBTWdELEdBQUdFLElBQUk7WUFDYixNQUFNeEIsNkJBQTZCcEQ7WUFDbkNHLE1BQU07Z0JBQ0pzQixPQUFPO2dCQUNQRSxRQUFRO2dCQUNSZ0IsVUFBVTtZQUNaO1lBQ0EsT0FBTztRQUNULEVBQUUsT0FBT2tDLEtBQWM7WUFDckJ2RCxRQUFRRSxLQUFLLENBQUMsOEJBQThCcUQ7WUFDNUMxRSxNQUFNO2dCQUNKc0IsT0FBTztnQkFDUEMsYUFBYW1ELGVBQWV4QixRQUFRd0IsSUFBSXRCLE9BQU8sR0FBRztnQkFDbEQ1QixRQUFRO2dCQUNSZ0IsVUFBVTtZQUNaO1lBQ0EsT0FBTztRQUNULFNBQVU7WUFDUnZDLGFBQWE7UUFDZjtJQUNGO0lBRUEsTUFBTXlILHlCQUF5QixPQUFPaEU7UUFDcEMsSUFBSSxDQUFDbkUsMEJBQTBCLENBQUNNLFNBQVM7WUFDdkMsTUFBTSxJQUFJcUQsTUFBTTtRQUNsQjtRQUVBLDJCQUEyQjtRQUMzQixJQUFJLENBQUNRLEtBQUtQLElBQUksSUFBSSxDQUFDTyxLQUFLQyxRQUFRLElBQUksQ0FBQ0QsS0FBS0UsVUFBVSxJQUFJLENBQUNGLEtBQUtHLE9BQU8sSUFDakUsQ0FBQ0gsS0FBS25DLFdBQVcsSUFBSSxDQUFDbUMsS0FBS0ksUUFBUSxJQUFJLENBQUNKLEtBQUtLLE9BQU8sSUFBSSxDQUFDTCxLQUFLTSxLQUFLLElBQUksQ0FBQ04sS0FBS08sS0FBSyxFQUFFO1lBQ3RGLE1BQU0sSUFBSWYsTUFBTTtRQUNsQjtRQUVBLElBQUk7WUFDRmpELGFBQWE7WUFDYixNQUFNc0UsS0FBSyxNQUFNaEYsdUJBQXVCb0ksS0FBSyxDQUFDQyx3QkFBd0IsQ0FBQztnQkFDckVDLE1BQU07b0JBQ0puRSxLQUFLUCxJQUFJO29CQUNUTyxLQUFLQyxRQUFRO29CQUNiRCxLQUFLRSxVQUFVO29CQUNmRixLQUFLRyxPQUFPO29CQUNaSCxLQUFLbkMsV0FBVztvQkFDaEJtQyxLQUFLSSxRQUFRLElBQUk7b0JBQ2pCSixLQUFLSyxPQUFPLElBQUk7b0JBQ2hCTCxLQUFLTSxLQUFLLElBQUk7b0JBQ2ROLEtBQUtPLEtBQUssSUFBSTtpQkFDZjtZQUNIO1lBQ0EsTUFBTU0sR0FBR0UsSUFBSTtZQUNibkUsZUFBZW9EO1lBQ2YxRCxNQUFNO2dCQUNKc0IsT0FBTztnQkFDUEUsUUFBUTtnQkFDUmdCLFVBQVU7Z0JBQ1ZDLFlBQVk7WUFDZDtRQUNGLEVBQUUsT0FBT3BCLE9BQU87WUFDZEYsUUFBUUUsS0FBSyxDQUFDLHFDQUFxQ0E7WUFDbkRyQixNQUFNO2dCQUNKc0IsT0FBTztnQkFDUEMsYUFBYUYsaUJBQWlCNkIsUUFBUTdCLE1BQU0rQixPQUFPLEdBQUc7Z0JBQ3RENUIsUUFBUTtnQkFDUmdCLFVBQVU7Z0JBQ1ZDLFlBQVk7WUFDZDtZQUNBLE1BQU1wQjtRQUNSLFNBQVU7WUFDUnBCLGFBQWE7UUFDZjtJQUNGO0lBRUEsT0FBTztRQUNMSTtRQUNBRTtRQUNBRTtRQUNBZDtRQUNBRjtRQUNBa0I7UUFDQUU7UUFDQUU7UUFDQTJHO1FBQ0F0RDtRQUNBTztRQUNBRTtRQUNBRTtRQUNBdUM7UUFDQXBDO1FBQ0FzQztJQUNGO0FBQ0YsRUFBRSIsInNvdXJjZXMiOlsid2VicGFjazovL19OX0UvLi9ob29rcy91c2VJbnN0aXR1dGlvbi50cz9mYTc2Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHVzZVN0YXRlLCB1c2VFZmZlY3QsIHVzZUNhbGxiYWNrIH0gZnJvbSAncmVhY3QnO1xuaW1wb3J0IHsgdXNlVG9hc3QgfSBmcm9tICdAY2hha3JhLXVpL3JlYWN0JztcbmltcG9ydCB7IHVzZVJvdXRlciB9IGZyb20gJ25leHQvcm91dGVyJztcbmltcG9ydCB7IGV0aGVycyB9IGZyb20gJ2V0aGVycyc7XG5pbXBvcnQge1xuICBnZXRVc2VyUm9sZSxcbiAgaXNWZXJpZmllZFVzZXIsXG4gIGdldENlcnRpZmljYXRlcyxcbiAgZ2V0SW5zdGl0dXRpb25FeGFtcyxcbiAgdXBkYXRlRXhhbVN0YXR1cyxcbiAgc3VibWl0RXhhbVJlc3VsdCxcbiAgZ2V0RXhhbVJlc3VsdCxcbiAgZW5yb2xsU3R1ZGVudCxcbiAgY3JlYXRlRXhhbSxcbiAgZ2V0Q29udHJhY3Rcbn0gZnJvbSAnLi4vdXRpbHMvY29udHJhY3RzJztcbmltcG9ydCB7IHVwbG9hZFRvSVBGUywgZ2V0RnJvbUlQRlMgfSBmcm9tICcuLi91dGlscy9pcGZzJztcbmltcG9ydCB7IENlcnRpZmljYXRlLCBFeGFtLCBFeGFtUmVzdWx0LCBFeGFtU3RhdGlzdGljcywgTmV3RXhhbSB9IGZyb20gJy4uL3R5cGVzL2luc3RpdHV0aW9uJztcbmltcG9ydCB7IHVzZUFjY291bnQgfSBmcm9tICd3YWdtaSc7XG5pbXBvcnQgeyB1c2VDb250cmFjdCB9IGZyb20gJy4vdXNlQ29udHJhY3QnO1xuaW1wb3J0IHsgSW5zdGl0dXRpb25EYXRhIH0gZnJvbSAnLi4vY29tcG9uZW50cy9pbnN0aXR1dGlvbi9JbnN0aXR1dGlvblByb2ZpbGUnO1xuXG4vLyBBZGQgdHlwZSBmb3IgbG9jYWwgc3RvcmFnZVxuY29uc3QgSU5TVElUVVRJT05fU1RPUkFHRV9LRVkgPSAnaW5zdGl0dXRpb25fZGF0YSc7XG5jb25zdCBFWEFNU19TVE9SQUdFX0tFWSA9ICdpbnN0aXR1dGlvbl9leGFtcyc7XG5jb25zdCBDRVJUSUZJQ0FURVNfU1RPUkFHRV9LRVkgPSAnaW5zdGl0dXRpb25fY2VydGlmaWNhdGVzJztcblxuZXhwb3J0IGNvbnN0IHVzZUluc3RpdHV0aW9uID0gKCkgPT4ge1xuICBjb25zdCB7IFxuICAgIGV4YW1NYW5hZ2VtZW50Q29udHJhY3QsIFxuICAgIGNlcnRpZmljYXRlc0NvbnRyYWN0LCBcbiAgICBpc0luaXRpYWxpemVkOiBjb250cmFjdHNJbml0aWFsaXplZCxcbiAgICBpc0xvYWRpbmc6IGNvbnRyYWN0c0xvYWRpbmcgXG4gIH0gPSB1c2VDb250cmFjdCgpO1xuICBjb25zdCB7IGFkZHJlc3MgPSB1bmRlZmluZWQsIGlzQ29ubmVjdGVkID0gZmFsc2UgfSA9IHVzZUFjY291bnQoKSB8fCB7fTtcbiAgY29uc3QgdG9hc3QgPSB1c2VUb2FzdCgpO1xuICBcbiAgY29uc3QgW2lzTG9hZGluZywgc2V0SXNMb2FkaW5nXSA9IHVzZVN0YXRlKHRydWUpO1xuICBjb25zdCBbaXNJbml0aWFsaXplZCwgc2V0SXNJbml0aWFsaXplZF0gPSB1c2VTdGF0ZShmYWxzZSk7XG4gIGNvbnN0IFtpbml0aWFsaXphdGlvbkF0dGVtcHRzLCBzZXRJbml0aWFsaXphdGlvbkF0dGVtcHRzXSA9IHVzZVN0YXRlKDApO1xuICBjb25zdCBbaW5zdGl0dXRpb24sIHNldEluc3RpdHV0aW9uXSA9IHVzZVN0YXRlPEluc3RpdHV0aW9uRGF0YSB8IG51bGw+KG51bGwpO1xuICBjb25zdCBbZXhhbXMsIHNldEV4YW1zXSA9IHVzZVN0YXRlPEV4YW1bXT4oW10pO1xuICBjb25zdCBbY2VydGlmaWNhdGVzLCBzZXRDZXJ0aWZpY2F0ZXNdID0gdXNlU3RhdGU8Q2VydGlmaWNhdGVbXT4oW10pO1xuICBjb25zdCBbaGFzQWNjZXNzLCBzZXRIYXNBY2Nlc3NdID0gdXNlU3RhdGUoZmFsc2UpO1xuICBjb25zdCBbc2VsZWN0ZWRFeGFtUmVzdWx0cywgc2V0U2VsZWN0ZWRFeGFtUmVzdWx0c10gPSB1c2VTdGF0ZTxFeGFtUmVzdWx0W10+KFtdKTtcbiAgY29uc3QgW2V4YW1TdGF0aXN0aWNzLCBzZXRFeGFtU3RhdGlzdGljc10gPSB1c2VTdGF0ZTxFeGFtU3RhdGlzdGljcyB8IG51bGw+KG51bGwpO1xuXG4gIGNvbnN0IGNoZWNrQWNjZXNzID0gYXN5bmMgKHVzZXJBZGRyZXNzOiBzdHJpbmcpID0+IHtcbiAgICBjb25zb2xlLmxvZygnW0NoZWNrQWNjZXNzXSBTdGFydGluZyBhY2Nlc3MgY2hlY2sgZm9yOicsIHVzZXJBZGRyZXNzKTtcblxuICAgIGlmICghZXhhbU1hbmFnZW1lbnRDb250cmFjdCkge1xuICAgICAgY29uc29sZS5lcnJvcignW0NoZWNrQWNjZXNzXSBDb250cmFjdCBub3QgaW5pdGlhbGl6ZWQnKTtcbiAgICAgIHRvYXN0KHsgXG4gICAgICAgIHRpdGxlOiAnRXJyb3InLFxuICAgICAgICBkZXNjcmlwdGlvbjogJ0NvbnRyYWN0IG5vdCBpbml0aWFsaXplZC4gUGxlYXNlIHRyeSBhZ2Fpbi4nLFxuICAgICAgICBzdGF0dXM6ICdlcnJvcidcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIHRyeSB7XG4gICAgICBjb25zb2xlLmxvZygnW0NoZWNrQWNjZXNzXSBDaGVja2luZyBpZiBhZGRyZXNzIGlzIGluc3RpdHV0aW9uLi4uJyk7XG4gICAgICBjb25zdCBpc0luc3RpdHV0aW9uUmVzdWx0ID0gYXdhaXQgZXhhbU1hbmFnZW1lbnRDb250cmFjdC5pc0luc3RpdHV0aW9uKHVzZXJBZGRyZXNzKTtcbiAgICAgIGNvbnNvbGUubG9nKCdbQ2hlY2tBY2Nlc3NdIGlzSW5zdGl0dXRpb24gcmVzdWx0OicsIGlzSW5zdGl0dXRpb25SZXN1bHQpO1xuXG4gICAgICBpZiAoIWlzSW5zdGl0dXRpb25SZXN1bHQpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ1tDaGVja0FjY2Vzc10gQWRkcmVzcyBpcyBub3QgcmVnaXN0ZXJlZCBhcyBpbnN0aXR1dGlvbicpO1xuICAgICAgICB0b2FzdCh7IFxuICAgICAgICAgIHRpdGxlOiAnRXJyb3InLFxuICAgICAgICAgIGRlc2NyaXB0aW9uOiAnQWRkcmVzcyBpcyBub3QgcmVnaXN0ZXJlZCBhcyBhbiBpbnN0aXR1dGlvbicsXG4gICAgICAgICAgc3RhdHVzOiAnZXJyb3InXG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG5cbiAgICAgIGNvbnNvbGUubG9nKCdbQ2hlY2tBY2Nlc3NdIEdldHRpbmcgaW5zdGl0dXRpb24gZGF0YS4uLicpO1xuICAgICAgY29uc3QgaW5zdGl0dXRpb25EYXRhID0gYXdhaXQgZXhhbU1hbmFnZW1lbnRDb250cmFjdC5nZXRJbnN0aXR1dGlvbih1c2VyQWRkcmVzcyk7XG4gICAgICBjb25zb2xlLmxvZygnW0NoZWNrQWNjZXNzXSBJbnN0aXR1dGlvbiBkYXRhOicsIGluc3RpdHV0aW9uRGF0YSk7XG5cbiAgICAgIGlmICghaW5zdGl0dXRpb25EYXRhIHx8IGluc3RpdHV0aW9uRGF0YS5sZW5ndGggPCAxMCkge1xuICAgICAgICBjb25zb2xlLmVycm9yKCdbQ2hlY2tBY2Nlc3NdIEludmFsaWQgaW5zdGl0dXRpb24gZGF0YSByZWNlaXZlZCcpO1xuICAgICAgICB0b2FzdCh7IFxuICAgICAgICAgIHRpdGxlOiAnRXJyb3InLFxuICAgICAgICAgIGRlc2NyaXB0aW9uOiAnSW52YWxpZCBpbnN0aXR1dGlvbiBkYXRhJyxcbiAgICAgICAgICBzdGF0dXM6ICdlcnJvcidcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgaXNWZXJpZmllZCA9IEJvb2xlYW4oaW5zdGl0dXRpb25EYXRhWzldKTtcbiAgICAgIGNvbnNvbGUubG9nKCdbQ2hlY2tBY2Nlc3NdIEluc3RpdHV0aW9uIHZlcmlmaWNhdGlvbiBzdGF0dXM6JywgaXNWZXJpZmllZCk7XG5cbiAgICAgIGlmICghaXNWZXJpZmllZCkge1xuICAgICAgICB0b2FzdCh7IFxuICAgICAgICAgIHRpdGxlOiAnRXJyb3InLFxuICAgICAgICAgIGRlc2NyaXB0aW9uOiAnSW5zdGl0dXRpb24gaXMgbm90IHZlcmlmaWVkJyxcbiAgICAgICAgICBzdGF0dXM6ICdlcnJvcidcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cblxuICAgICAgY29uc29sZS5sb2coJ1tDaGVja0FjY2Vzc10gQWNjZXNzIGdyYW50ZWQnKTtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdbQ2hlY2tBY2Nlc3NdIEVycm9yIGNoZWNraW5nIGFjY2VzczonLCBlcnJvcik7XG4gICAgICB0b2FzdCh7IFxuICAgICAgICB0aXRsZTogJ0Vycm9yJyxcbiAgICAgICAgZGVzY3JpcHRpb246ICdFcnJvciBjaGVja2luZyBpbnN0aXR1dGlvbiBhY2Nlc3MnLFxuICAgICAgICBzdGF0dXM6ICdlcnJvcidcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgfTtcblxuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIGxldCBpc01vdW50ZWQgPSB0cnVlO1xuICAgIGxldCBpbml0VGltZW91dDogTm9kZUpTLlRpbWVvdXQ7XG5cbiAgICBjb25zdCBpbml0aWFsaXplRGF0YSA9IGFzeW5jICgpID0+IHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdTdGFydGluZyBpbml0aWFsaXphdGlvbiBjaGVjazonLCB7XG4gICAgICAgICAgaXNDb25uZWN0ZWQsXG4gICAgICAgICAgaGFzQWRkcmVzczogISFhZGRyZXNzLFxuICAgICAgICAgIGhhc0NvbnRyYWN0OiAhIWV4YW1NYW5hZ2VtZW50Q29udHJhY3QsXG4gICAgICAgICAgY29udHJhY3RzSW5pdGlhbGl6ZWQsXG4gICAgICAgICAgY29udHJhY3RzTG9hZGluZyxcbiAgICAgICAgICBhdHRlbXB0czogaW5pdGlhbGl6YXRpb25BdHRlbXB0c1xuICAgICAgICB9KTtcblxuICAgICAgICBpZiAoIWlzQ29ubmVjdGVkIHx8ICFhZGRyZXNzKSB7XG4gICAgICAgICAgY29uc29sZS5sb2coJ05vdCBjb25uZWN0ZWQgb3Igbm8gYWRkcmVzcycpO1xuICAgICAgICAgIGlmIChpc01vdW50ZWQpIHtcbiAgICAgICAgICAgIHNldElzTG9hZGluZyhmYWxzZSk7XG4gICAgICAgICAgICBzZXRIYXNBY2Nlc3MoZmFsc2UpO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICAvLyBXYWl0IGZvciBjb250cmFjdHMgdG8gZmluaXNoIGxvYWRpbmdcbiAgICAgICAgaWYgKGNvbnRyYWN0c0xvYWRpbmcpIHtcbiAgICAgICAgICBjb25zb2xlLmxvZygnQ29udHJhY3RzIGFyZSBzdGlsbCBsb2FkaW5nLi4uJyk7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCFleGFtTWFuYWdlbWVudENvbnRyYWN0IHx8ICFjZXJ0aWZpY2F0ZXNDb250cmFjdCB8fCAhY29udHJhY3RzSW5pdGlhbGl6ZWQpIHtcbiAgICAgICAgICBjb25zb2xlLmVycm9yKCdDb250cmFjdHMgbm90IGluaXRpYWxpemVkJyk7XG4gICAgICAgICAgaWYgKGlzTW91bnRlZCkge1xuICAgICAgICAgICAgc2V0SXNMb2FkaW5nKGZhbHNlKTtcbiAgICAgICAgICAgIHNldEhhc0FjY2VzcyhmYWxzZSk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIFJldHJ5IGluaXRpYWxpemF0aW9uIGlmIHVuZGVyIG1heCBhdHRlbXB0c1xuICAgICAgICAgICAgaWYgKGluaXRpYWxpemF0aW9uQXR0ZW1wdHMgPCAzKSB7XG4gICAgICAgICAgICAgIGluaXRUaW1lb3V0ID0gc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgc2V0SW5pdGlhbGl6YXRpb25BdHRlbXB0cyhwcmV2ID0+IHByZXYgKyAxKTtcbiAgICAgICAgICAgICAgfSwgMTAwMCAqIChpbml0aWFsaXphdGlvbkF0dGVtcHRzICsgMSkpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgLy8gU2hvdyBlcnJvciB0b2FzdCBhZnRlciBtYXggYXR0ZW1wdHNcbiAgICAgICAgICAgICAgdG9hc3Qoe1xuICAgICAgICAgICAgICAgIHRpdGxlOiAn2K7Yt9ijINmB2Yog2KrZh9mK2KbYqSDYp9mE2LnZgtmI2K8gfCBDb250cmFjdCBJbml0aWFsaXphdGlvbiBFcnJvcicsXG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb246ICfZgdi02YQg2YHZiiDYqtmH2YrYptipINin2YTYudmC2YjYryDYqNi52K8g2LnYr9ipINmF2K3Yp9mI2YTYp9iqIHwgRmFpbGVkIHRvIGluaXRpYWxpemUgY29udHJhY3RzIGFmdGVyIHNldmVyYWwgYXR0ZW1wdHMnLFxuICAgICAgICAgICAgICAgIHN0YXR1czogJ2Vycm9yJyxcbiAgICAgICAgICAgICAgICBkdXJhdGlvbjogNTAwMCxcbiAgICAgICAgICAgICAgICBpc0Nsb3NhYmxlOiB0cnVlLFxuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gUmVzZXQgYXR0ZW1wdHMgb24gc3VjY2Vzc2Z1bCBpbml0aWFsaXphdGlvblxuICAgICAgICBpZiAoaW5pdGlhbGl6YXRpb25BdHRlbXB0cyA+IDApIHtcbiAgICAgICAgICBzZXRJbml0aWFsaXphdGlvbkF0dGVtcHRzKDApO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGlzTW91bnRlZCkge1xuICAgICAgICAgIHNldElzTG9hZGluZyh0cnVlKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIENoZWNrIGFjY2VzcyBmaXJzdFxuICAgICAgICBjb25zdCBhY2Nlc3NHcmFudGVkID0gYXdhaXQgY2hlY2tBY2Nlc3MoYWRkcmVzcyk7XG4gICAgICAgIGNvbnNvbGUubG9nKCdBY2Nlc3MgY2hlY2sgcmVzdWx0OicsIGFjY2Vzc0dyYW50ZWQpO1xuICAgICAgICBcbiAgICAgICAgaWYgKCFpc01vdW50ZWQpIHJldHVybjtcbiAgICAgICAgXG4gICAgICAgIHNldEhhc0FjY2VzcyhhY2Nlc3NHcmFudGVkKTtcblxuICAgICAgICBpZiAoIWFjY2Vzc0dyYW50ZWQpIHtcbiAgICAgICAgICBzZXRJc0xvYWRpbmcoZmFsc2UpO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIExvYWQgZGF0YSBvbmx5IGlmIGFjY2VzcyBpcyBncmFudGVkXG4gICAgICAgIGNvbnN0IFtpbnN0aXR1dGlvbkRhdGEsIGV4YW1zRGF0YSwgY2VydGlmaWNhdGVzRGF0YV0gPSBhd2FpdCBQcm9taXNlLmFsbChbXG4gICAgICAgICAgbG9hZEluc3RpdHV0aW9uRnJvbUNvbnRyYWN0KGFkZHJlc3MpLFxuICAgICAgICAgIGxvYWRFeGFtc0Zyb21Db250cmFjdChhZGRyZXNzKSxcbiAgICAgICAgICBsb2FkQ2VydGlmaWNhdGVzRnJvbUNvbnRyYWN0KGFkZHJlc3MpXG4gICAgICAgIF0pO1xuXG4gICAgICAgIGlmICghaXNNb3VudGVkKSByZXR1cm47XG5cbiAgICAgICAgaWYgKGluc3RpdHV0aW9uRGF0YSkge1xuICAgICAgICAgIHNldEluc3RpdHV0aW9uKGluc3RpdHV0aW9uRGF0YSk7XG4gICAgICAgICAgc2V0SXNJbml0aWFsaXplZCh0cnVlKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChleGFtc0RhdGEpIHtcbiAgICAgICAgICBzZXRFeGFtcyhleGFtc0RhdGEpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGNlcnRpZmljYXRlc0RhdGEpIHtcbiAgICAgICAgICBzZXRDZXJ0aWZpY2F0ZXMoY2VydGlmaWNhdGVzRGF0YSk7XG4gICAgICAgIH1cblxuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcignQ3JpdGljYWwgaW5pdGlhbGl6YXRpb24gZXJyb3I6Jywge1xuICAgICAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8ge1xuICAgICAgICAgICAgbmFtZTogZXJyb3IubmFtZSxcbiAgICAgICAgICAgIG1lc3NhZ2U6IGVycm9yLm1lc3NhZ2UsXG4gICAgICAgICAgICBzdGFjazogZXJyb3Iuc3RhY2tcbiAgICAgICAgICB9IDogJ1Vua25vd24gZXJyb3InLFxuICAgICAgICAgIGFkZHJlc3MsXG4gICAgICAgICAgY29udHJhY3RTdGF0dXM6IHtcbiAgICAgICAgICAgIGhhc0V4YW1Db250cmFjdDogISFleGFtTWFuYWdlbWVudENvbnRyYWN0LFxuICAgICAgICAgICAgaGFzQ2VydGlmaWNhdGVzQ29udHJhY3Q6ICEhY2VydGlmaWNhdGVzQ29udHJhY3QsXG4gICAgICAgICAgICBpc0luaXRpYWxpemVkOiBjb250cmFjdHNJbml0aWFsaXplZCxcbiAgICAgICAgICAgIGlzTG9hZGluZzogY29udHJhY3RzTG9hZGluZ1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIFxuICAgICAgICBpZiAoaXNNb3VudGVkKSB7XG4gICAgICAgICAgdG9hc3Qoe1xuICAgICAgICAgICAgdGl0bGU6ICfYrti32KMg2YHZiiDYqtmH2YrYptipINin2YTYqNmK2KfZhtin2KogfCBJbml0aWFsaXphdGlvbiBFcnJvcicsXG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciBcbiAgICAgICAgICAgICAgPyBgJHtlcnJvci5tZXNzYWdlfSB8INit2K/YqyDYrti32KMg2KPYq9mG2KfYoSDYqtit2YXZitmEINin2YTYqNmK2KfZhtin2KpgIFxuICAgICAgICAgICAgICA6ICfYrdiv2Ksg2K7Yt9ijINi62YrYsSDZhdi52LHZiNmBIHwgQW4gdW5rbm93biBlcnJvciBvY2N1cnJlZCcsXG4gICAgICAgICAgICBzdGF0dXM6ICdlcnJvcicsXG4gICAgICAgICAgICBkdXJhdGlvbjogNTAwMCxcbiAgICAgICAgICAgIGlzQ2xvc2FibGU6IHRydWUsXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgXG4gICAgICAgICAgc2V0SGFzQWNjZXNzKGZhbHNlKTtcbiAgICAgICAgfVxuICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgaWYgKGlzTW91bnRlZCkge1xuICAgICAgICAgIHNldElzTG9hZGluZyhmYWxzZSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9O1xuXG4gICAgaW5pdGlhbGl6ZURhdGEoKTtcblxuICAgIHJldHVybiAoKSA9PiB7XG4gICAgICBpc01vdW50ZWQgPSBmYWxzZTtcbiAgICAgIGlmIChpbml0VGltZW91dCkge1xuICAgICAgICBjbGVhclRpbWVvdXQoaW5pdFRpbWVvdXQpO1xuICAgICAgfVxuICAgIH07XG4gIH0sIFtcbiAgICBpc0Nvbm5lY3RlZCwgXG4gICAgYWRkcmVzcywgXG4gICAgZXhhbU1hbmFnZW1lbnRDb250cmFjdCwgXG4gICAgY2VydGlmaWNhdGVzQ29udHJhY3QsIFxuICAgIGNvbnRyYWN0c0luaXRpYWxpemVkLFxuICAgIGNvbnRyYWN0c0xvYWRpbmcsXG4gICAgaW5pdGlhbGl6YXRpb25BdHRlbXB0c1xuICBdKTtcblxuICAvLyBIZWxwZXIgZnVuY3Rpb25zIHdpdGggcHJvcGVyIHR5cGUgY2hlY2tpbmdcbiAgY29uc3QgbG9hZEluc3RpdHV0aW9uRnJvbUNvbnRyYWN0ID0gYXN5bmMgKHVzZXJBZGRyZXNzOiBgMHgke3N0cmluZ31gKTogUHJvbWlzZTxJbnN0aXR1dGlvbkRhdGEgfCBudWxsPiA9PiB7XG4gICAgaWYgKCFleGFtTWFuYWdlbWVudENvbnRyYWN0IHx8ICF1c2VyQWRkcmVzcykgcmV0dXJuIG51bGw7XG5cbiAgICB0cnkge1xuICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IGV4YW1NYW5hZ2VtZW50Q29udHJhY3QuZ2V0SW5zdGl0dXRpb24odXNlckFkZHJlc3MpO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgbmFtZTogZGF0YS5uYW1lLFxuICAgICAgICBtaW5pc3RyeTogZGF0YS5taW5pc3RyeSxcbiAgICAgICAgdW5pdmVyc2l0eTogZGF0YS51bml2ZXJzaXR5LFxuICAgICAgICBjb2xsZWdlOiBkYXRhLmNvbGxlZ2UsXG4gICAgICAgIGRlc2NyaXB0aW9uOiBkYXRhLmRlc2NyaXB0aW9uLFxuICAgICAgICBpbWFnZVVybDogZGF0YS5pbWFnZVVybCxcbiAgICAgICAgd2Vic2l0ZTogZGF0YS53ZWJzaXRlLFxuICAgICAgICBlbWFpbDogZGF0YS5lbWFpbCxcbiAgICAgICAgcGhvbmU6IGRhdGEucGhvbmUsXG4gICAgICB9O1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBsb2FkaW5nIGluc3RpdHV0aW9uOicsIGVycm9yKTtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgfTtcblxuICBjb25zdCBsb2FkRXhhbXNGcm9tQ29udHJhY3QgPSBhc3luYyAodXNlckFkZHJlc3M6IGAweCR7c3RyaW5nfWApOiBQcm9taXNlPEV4YW1bXT4gPT4ge1xuICAgIGlmICghZXhhbU1hbmFnZW1lbnRDb250cmFjdCB8fCAhdXNlckFkZHJlc3MpIHtcbiAgICAgIHJldHVybiBbXTtcbiAgICB9XG5cbiAgICB0cnkge1xuICAgICAgcmV0dXJuIGF3YWl0IGV4YW1NYW5hZ2VtZW50Q29udHJhY3QuZ2V0SW5zdGl0dXRpb25FeGFtcyh1c2VyQWRkcmVzcyk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGxvYWRpbmcgZXhhbXM6JywgZXJyb3IpO1xuICAgICAgcmV0dXJuIFtdO1xuICAgIH1cbiAgfTtcblxuICBjb25zdCBsb2FkQ2VydGlmaWNhdGVzRnJvbUNvbnRyYWN0ID0gYXN5bmMgKHVzZXJBZGRyZXNzOiBgMHgke3N0cmluZ31gKTogUHJvbWlzZTxDZXJ0aWZpY2F0ZVtdPiA9PiB7XG4gICAgaWYgKCFjZXJ0aWZpY2F0ZXNDb250cmFjdCB8fCAhdXNlckFkZHJlc3MpIHtcbiAgICAgIHJldHVybiBbXTtcbiAgICB9XG5cbiAgICB0cnkge1xuICAgICAgcmV0dXJuIGF3YWl0IGNlcnRpZmljYXRlc0NvbnRyYWN0LmdldEluc3RpdHV0aW9uQ2VydGlmaWNhdGVzKHVzZXJBZGRyZXNzKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgbG9hZGluZyBjZXJ0aWZpY2F0ZXM6JywgZXJyb3IpO1xuICAgICAgcmV0dXJuIFtdO1xuICAgIH1cbiAgfTtcblxuICBjb25zdCBjcmVhdGVFeGFtID0gYXN5bmMgKGV4YW06IE5ld0V4YW0pOiBQcm9taXNlPGJvb2xlYW4+ID0+IHtcbiAgICBpZiAoIWFkZHJlc3MpIHtcbiAgICAgIHRvYXN0KHtcbiAgICAgICAgdGl0bGU6ICfYrti32KMg2YHZiiDYp9mE2LnZhtmI2KfZhiB8IEFkZHJlc3MgRXJyb3InLFxuICAgICAgICBkZXNjcmlwdGlvbjogJ9mE2YUg2YrYqtmFINin2YTYudir2YjYsSDYudmE2Ykg2LnZhtmI2KfZhiDYp9mE2YXYrdmB2LjYqSB8IFdhbGxldCBhZGRyZXNzIG5vdCBmb3VuZCcsXG4gICAgICAgIHN0YXR1czogJ2Vycm9yJyxcbiAgICAgICAgZHVyYXRpb246IDMwMDAsXG4gICAgICB9KTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICB0cnkge1xuICAgICAgc2V0SXNMb2FkaW5nKHRydWUpO1xuICAgICAgY29uc3QgY29udHJhY3QgPSBhd2FpdCBnZXRDb250cmFjdCgpO1xuICAgICAgY29uc3QgdHggPSBhd2FpdCBjb250cmFjdC5jcmVhdGVFeGFtKGV4YW0udGl0bGUsIGV4YW0uZGVzY3JpcHRpb24sIGV4YW0uZGF0ZSk7XG4gICAgICBhd2FpdCB0eC53YWl0KCk7XG4gICAgICBhd2FpdCBsb2FkRXhhbXNGcm9tQ29udHJhY3QoYWRkcmVzcyk7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9IGNhdGNoIChlcnI6IGFueSkge1xuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgY3JlYXRpbmcgZXhhbTonLCBlcnIpO1xuICAgICAgdG9hc3Qoe1xuICAgICAgICB0aXRsZTogJ0Vycm9yIGNyZWF0aW5nIGV4YW0nLFxuICAgICAgICBkZXNjcmlwdGlvbjogZXJyIGluc3RhbmNlb2YgRXJyb3IgPyBlcnIubWVzc2FnZSA6ICdBbiB1bmtub3duIGVycm9yIG9jY3VycmVkJyxcbiAgICAgICAgc3RhdHVzOiAnZXJyb3InLFxuICAgICAgICBkdXJhdGlvbjogMzAwMCxcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH0gZmluYWxseSB7XG4gICAgICBzZXRJc0xvYWRpbmcoZmFsc2UpO1xuICAgIH1cbiAgfTtcblxuICBjb25zdCB1cGRhdGVFeGFtU3RhdHVzID0gYXN5bmMgKGV4YW1JZDogc3RyaW5nLCBzdGF0dXM6IHN0cmluZyk6IFByb21pc2U8Ym9vbGVhbj4gPT4ge1xuICAgIGlmICghYWRkcmVzcykge1xuICAgICAgdG9hc3Qoe1xuICAgICAgICB0aXRsZTogJ9iu2LfYoyDZgdmKINin2YTYudmG2YjYp9mGIHwgQWRkcmVzcyBFcnJvcicsXG4gICAgICAgIGRlc2NyaXB0aW9uOiAn2YTZhSDZitiq2YUg2KfZhNi52KvZiNixINi52YTZiSDYudmG2YjYp9mGINin2YTZhdit2YHYuNipIHwgV2FsbGV0IGFkZHJlc3Mgbm90IGZvdW5kJyxcbiAgICAgICAgc3RhdHVzOiAnZXJyb3InLFxuICAgICAgICBkdXJhdGlvbjogMzAwMCxcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIHRyeSB7XG4gICAgICBzZXRJc0xvYWRpbmcodHJ1ZSk7XG4gICAgICBjb25zdCBjb250cmFjdCA9IGF3YWl0IGdldENvbnRyYWN0KCk7XG4gICAgICBjb25zdCB0eCA9IGF3YWl0IGNvbnRyYWN0LnVwZGF0ZUV4YW1TdGF0dXMoZXhhbUlkLCBzdGF0dXMpO1xuICAgICAgYXdhaXQgdHgud2FpdCgpO1xuICAgICAgYXdhaXQgbG9hZEV4YW1zRnJvbUNvbnRyYWN0KGFkZHJlc3MpO1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSBjYXRjaCAoZXJyOiBhbnkpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHVwZGF0aW5nIGV4YW0gc3RhdHVzOicsIGVycik7XG4gICAgICB0b2FzdCh7XG4gICAgICAgIHRpdGxlOiAnRXJyb3IgdXBkYXRpbmcgZXhhbSBzdGF0dXMnLFxuICAgICAgICBkZXNjcmlwdGlvbjogZXJyIGluc3RhbmNlb2YgRXJyb3IgPyBlcnIubWVzc2FnZSA6ICdBbiB1bmtub3duIGVycm9yIG9jY3VycmVkJyxcbiAgICAgICAgc3RhdHVzOiAnZXJyb3InLFxuICAgICAgICBkdXJhdGlvbjogMzAwMCxcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH0gZmluYWxseSB7XG4gICAgICBzZXRJc0xvYWRpbmcoZmFsc2UpO1xuICAgIH1cbiAgfTtcblxuICBjb25zdCByZWdpc3RlclN0dWRlbnRzID0gYXN5bmMgKGV4YW1JZDogc3RyaW5nLCBzdHVkZW50czogc3RyaW5nW10pOiBQcm9taXNlPGJvb2xlYW4+ID0+IHtcbiAgICB0cnkge1xuICAgICAgc2V0SXNMb2FkaW5nKHRydWUpO1xuICAgICAgY29uc3QgY29udHJhY3QgPSBhd2FpdCBnZXRDb250cmFjdCgpO1xuICAgICAgY29uc3QgdHggPSBhd2FpdCBjb250cmFjdC5yZWdpc3RlclN0dWRlbnRzKGV4YW1JZCwgc3R1ZGVudHMpO1xuICAgICAgYXdhaXQgdHgud2FpdCgpO1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSBjYXRjaCAoZXJyOiBhbnkpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHJlZ2lzdGVyaW5nIHN0dWRlbnRzOicsIGVycik7XG4gICAgICB0b2FzdCh7XG4gICAgICAgIHRpdGxlOiAnRXJyb3IgcmVnaXN0ZXJpbmcgc3R1ZGVudHMnLFxuICAgICAgICBkZXNjcmlwdGlvbjogZXJyIGluc3RhbmNlb2YgRXJyb3IgPyBlcnIubWVzc2FnZSA6ICdBbiB1bmtub3duIGVycm9yIG9jY3VycmVkJyxcbiAgICAgICAgc3RhdHVzOiAnZXJyb3InLFxuICAgICAgICBkdXJhdGlvbjogMzAwMCxcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH0gZmluYWxseSB7XG4gICAgICBzZXRJc0xvYWRpbmcoZmFsc2UpO1xuICAgIH1cbiAgfTtcblxuICBjb25zdCBoYW5kbGVTdWJtaXRSZXN1bHRzID0gYXN5bmMgKGV4YW1JZDogc3RyaW5nLCByZXN1bHRzOiBFeGFtUmVzdWx0W10pOiBQcm9taXNlPGJvb2xlYW4+ID0+IHtcbiAgICB0cnkge1xuICAgICAgc2V0SXNMb2FkaW5nKHRydWUpO1xuICAgICAgY29uc3QgY29udHJhY3QgPSBhd2FpdCBnZXRDb250cmFjdCgpO1xuICAgICAgY29uc3QgdHggPSBhd2FpdCBjb250cmFjdC5zdWJtaXRSZXN1bHRzKGV4YW1JZCwgcmVzdWx0cyk7XG4gICAgICBhd2FpdCB0eC53YWl0KCk7XG4gICAgICBhd2FpdCBsb2FkRXhhbVJlc3VsdHMoZXhhbUlkKTtcbiAgICAgIHRvYXN0KHtcbiAgICAgICAgdGl0bGU6ICfYqtmFINil2LbYp9mB2Kkg2KfZhNmG2KrYp9im2Kwg2KjZhtis2KfYrSB8IFJlc3VsdHMgc3VibWl0dGVkIHN1Y2Nlc3NmdWxseScsXG4gICAgICAgIHN0YXR1czogJ3N1Y2Nlc3MnLFxuICAgICAgICBkdXJhdGlvbjogMzAwMCxcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSBjYXRjaCAoZXJyOiB1bmtub3duKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBzdWJtaXR0aW5nIHJlc3VsdHM6JywgZXJyKTtcbiAgICAgIHRvYXN0KHtcbiAgICAgICAgdGl0bGU6ICfYrdiv2Ksg2K7Yt9ijIHwgRXJyb3Igb2NjdXJyZWQnLFxuICAgICAgICBkZXNjcmlwdGlvbjogZXJyIGluc3RhbmNlb2YgRXJyb3IgPyBlcnIubWVzc2FnZSA6ICdBbiB1bmtub3duIGVycm9yIG9jY3VycmVkJyxcbiAgICAgICAgc3RhdHVzOiAnZXJyb3InLFxuICAgICAgICBkdXJhdGlvbjogMzAwMCxcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH0gZmluYWxseSB7XG4gICAgICBzZXRJc0xvYWRpbmcoZmFsc2UpO1xuICAgIH1cbiAgfTtcblxuICBjb25zdCBsb2FkRXhhbVJlc3VsdHMgPSBhc3luYyAoZXhhbUlkOiBzdHJpbmcpID0+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgY3VycmVudEV4YW0gPSBleGFtcy5maW5kKGV4YW0gPT4gZXhhbS5pZCA9PT0gZXhhbUlkKTtcbiAgICAgIGlmICghY3VycmVudEV4YW0pIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdFeGFtIG5vdCBmb3VuZCcpO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBleGFtUmVzdWx0c0xpc3QgPSBhd2FpdCBQcm9taXNlLmFsbChcbiAgICAgICAgY3VycmVudEV4YW0uc3R1ZGVudHMubWFwKGFzeW5jIChzdHVkZW50SWQ6IHN0cmluZykgPT4ge1xuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBnZXRFeGFtUmVzdWx0KGV4YW1JZCwgc3R1ZGVudElkKTtcbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgICAgfSBjYXRjaCB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgICApO1xuXG4gICAgICBjb25zdCB2YWxpZFJlc3VsdHMgPSBleGFtUmVzdWx0c0xpc3QuZmlsdGVyKChyZXN1bHQpOiByZXN1bHQgaXMgRXhhbVJlc3VsdCA9PiByZXN1bHQgIT09IG51bGwpO1xuICAgICAgc2V0U2VsZWN0ZWRFeGFtUmVzdWx0cyh2YWxpZFJlc3VsdHMpO1xuXG4gICAgICBpZiAodmFsaWRSZXN1bHRzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICBzZXRFeGFtU3RhdGlzdGljcyhudWxsKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICAvLyBDYWxjdWxhdGUgc3RhdGlzdGljc1xuICAgICAgY29uc3QgdG90YWxTdHVkZW50cyA9IHZhbGlkUmVzdWx0cy5sZW5ndGg7XG4gICAgICBjb25zdCBwYXNzaW5nU3R1ZGVudHMgPSB2YWxpZFJlc3VsdHMuZmlsdGVyKHJlc3VsdCA9PiByZXN1bHQuc2NvcmUgPj0gNjApLmxlbmd0aDtcbiAgICAgIGNvbnN0IHRvdGFsU2NvcmUgPSB2YWxpZFJlc3VsdHMucmVkdWNlKChzdW0sIHJlc3VsdCkgPT4gc3VtICsgcmVzdWx0LnNjb3JlLCAwKTtcbiAgICAgIFxuICAgICAgY29uc3QgZ3JhZGVDb3VudCA9IHtcbiAgICAgICAgQTogdmFsaWRSZXN1bHRzLmZpbHRlcihyZXN1bHQgPT4gcmVzdWx0LmdyYWRlID09PSAnQScpLmxlbmd0aCxcbiAgICAgICAgQjogdmFsaWRSZXN1bHRzLmZpbHRlcihyZXN1bHQgPT4gcmVzdWx0LmdyYWRlID09PSAnQicpLmxlbmd0aCxcbiAgICAgICAgQzogdmFsaWRSZXN1bHRzLmZpbHRlcihyZXN1bHQgPT4gcmVzdWx0LmdyYWRlID09PSAnQycpLmxlbmd0aCxcbiAgICAgICAgRDogdmFsaWRSZXN1bHRzLmZpbHRlcihyZXN1bHQgPT4gcmVzdWx0LmdyYWRlID09PSAnRCcpLmxlbmd0aCxcbiAgICAgICAgRjogdmFsaWRSZXN1bHRzLmZpbHRlcihyZXN1bHQgPT4gcmVzdWx0LmdyYWRlID09PSAnRicpLmxlbmd0aFxuICAgICAgfTtcblxuICAgICAgY29uc3QgbW9zdENvbW1vbkdyYWRlID0gT2JqZWN0LmVudHJpZXMoZ3JhZGVDb3VudClcbiAgICAgICAgLnJlZHVjZSgoYSwgYikgPT4gYVsxXSA+IGJbMV0gPyBhIDogYilbMF07XG5cbiAgICAgIHNldEV4YW1TdGF0aXN0aWNzKHtcbiAgICAgICAgdG90YWxTdHVkZW50cyxcbiAgICAgICAgcGFzc2luZ0NvdW50OiBwYXNzaW5nU3R1ZGVudHMsXG4gICAgICAgIGFDb3VudDogZ3JhZGVDb3VudC5BLFxuICAgICAgICBiQ291bnQ6IGdyYWRlQ291bnQuQixcbiAgICAgICAgY0NvdW50OiBncmFkZUNvdW50LkMsXG4gICAgICAgIGRDb3VudDogZ3JhZGVDb3VudC5ELFxuICAgICAgICBmQ291bnQ6IGdyYWRlQ291bnQuRixcbiAgICAgICAgYXZlcmFnZVNjb3JlOiB0b3RhbFNjb3JlIC8gdG90YWxTdHVkZW50cyxcbiAgICAgICAgcGFzc1JhdGU6IChwYXNzaW5nU3R1ZGVudHMgKiAxMDApIC8gdG90YWxTdHVkZW50cyxcbiAgICAgICAgbW9zdENvbW1vbkdyYWRlXG4gICAgICB9KTtcbiAgICB9IGNhdGNoIChlcnI6IHVua25vd24pIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGxvYWRpbmcgZXhhbSByZXN1bHRzOicsIGVycik7XG4gICAgICB0b2FzdCh7XG4gICAgICAgIHRpdGxlOiAnRXJyb3IgbG9hZGluZyByZXN1bHRzJyxcbiAgICAgICAgZGVzY3JpcHRpb246IGVyciBpbnN0YW5jZW9mIEVycm9yID8gZXJyLm1lc3NhZ2UgOiAnQW4gdW5rbm93biBlcnJvciBvY2N1cnJlZCcsXG4gICAgICAgIHN0YXR1czogJ2Vycm9yJyxcbiAgICAgICAgZHVyYXRpb246IDMwMDBcbiAgICAgIH0pO1xuICAgIH1cbiAgfTtcblxuICBjb25zdCBoYW5kbGVFbnJvbGxTdHVkZW50ID0gYXN5bmMgKGV4YW1JZDogc3RyaW5nLCBzdHVkZW50QWRkcmVzczogc3RyaW5nKSA9PiB7XG4gICAgaWYgKCFhZGRyZXNzKSB7XG4gICAgICB0b2FzdCh7XG4gICAgICAgIHRpdGxlOiAn2K7Yt9ijINmB2Yog2KfZhNi52YbZiNin2YYgfCBBZGRyZXNzIEVycm9yJyxcbiAgICAgICAgZGVzY3JpcHRpb246ICfZhNmFINmK2KrZhSDYp9mE2LnYq9mI2LEg2LnZhNmJINi52YbZiNin2YYg2KfZhNmF2K3Zgdi42KkgfCBXYWxsZXQgYWRkcmVzcyBub3QgZm91bmQnLFxuICAgICAgICBzdGF0dXM6ICdlcnJvcicsXG4gICAgICAgIGR1cmF0aW9uOiAzMDAwLFxuICAgICAgfSk7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgdHJ5IHtcbiAgICAgIHNldElzTG9hZGluZyh0cnVlKTtcbiAgICAgIGF3YWl0IGVucm9sbFN0dWRlbnQoZXhhbUlkLCBzdHVkZW50QWRkcmVzcyk7XG4gICAgICB0b2FzdCh7XG4gICAgICAgIHRpdGxlOiAnU3R1ZGVudCBlbnJvbGxlZCBzdWNjZXNzZnVsbHknLFxuICAgICAgICBzdGF0dXM6ICdzdWNjZXNzJyxcbiAgICAgICAgZHVyYXRpb246IDMwMDAsXG4gICAgICB9KTtcbiAgICAgIGF3YWl0IGxvYWRFeGFtc0Zyb21Db250cmFjdChhZGRyZXNzKTtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH0gY2F0Y2ggKGVycjogdW5rbm93bikge1xuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZW5yb2xsaW5nIHN0dWRlbnQ6JywgZXJyKTtcbiAgICAgIHRvYXN0KHtcbiAgICAgICAgdGl0bGU6ICdFcnJvciBlbnJvbGxpbmcgc3R1ZGVudCcsXG4gICAgICAgIGRlc2NyaXB0aW9uOiBlcnIgaW5zdGFuY2VvZiBFcnJvciA/IGVyci5tZXNzYWdlIDogJ0FuIHVua25vd24gZXJyb3Igb2NjdXJyZWQnLFxuICAgICAgICBzdGF0dXM6ICdlcnJvcicsXG4gICAgICAgIGR1cmF0aW9uOiAzMDAwLFxuICAgICAgfSk7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfSBmaW5hbGx5IHtcbiAgICAgIHNldElzTG9hZGluZyhmYWxzZSk7XG4gICAgfVxuICB9O1xuXG4gIGNvbnN0IGlzc3VlQ2VydGlmaWNhdGUgPSBhc3luYyAoc3R1ZGVudEFkZHJlc3M6IHN0cmluZywgY2VydGlmaWNhdGU6IHsgdGl0bGU6IHN0cmluZzsgZGVzY3JpcHRpb246IHN0cmluZyB9KTogUHJvbWlzZTxib29sZWFuPiA9PiB7XG4gICAgaWYgKCFhZGRyZXNzKSB7XG4gICAgICB0b2FzdCh7XG4gICAgICAgIHRpdGxlOiAn2K7Yt9ijINmB2Yog2KfZhNi52YbZiNin2YYgfCBBZGRyZXNzIEVycm9yJyxcbiAgICAgICAgZGVzY3JpcHRpb246ICfZhNmFINmK2KrZhSDYp9mE2LnYq9mI2LEg2LnZhNmJINi52YbZiNin2YYg2KfZhNmF2K3Zgdi42KkgfCBXYWxsZXQgYWRkcmVzcyBub3QgZm91bmQnLFxuICAgICAgICBzdGF0dXM6ICdlcnJvcicsXG4gICAgICAgIGR1cmF0aW9uOiAzMDAwLFxuICAgICAgfSk7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgdHJ5IHtcbiAgICAgIHNldElzTG9hZGluZyh0cnVlKTtcbiAgICAgIGNvbnN0IGNvbnRyYWN0ID0gYXdhaXQgZ2V0Q29udHJhY3QoKTtcbiAgICAgIGNvbnN0IHR4ID0gYXdhaXQgY29udHJhY3QuaXNzdWVDZXJ0aWZpY2F0ZShzdHVkZW50QWRkcmVzcywgY2VydGlmaWNhdGUudGl0bGUsIGNlcnRpZmljYXRlLmRlc2NyaXB0aW9uKTtcbiAgICAgIGF3YWl0IHR4LndhaXQoKTtcbiAgICAgIGF3YWl0IGxvYWRDZXJ0aWZpY2F0ZXNGcm9tQ29udHJhY3QoYWRkcmVzcyk7XG4gICAgICB0b2FzdCh7XG4gICAgICAgIHRpdGxlOiAnQ2VydGlmaWNhdGUgaXNzdWVkIHN1Y2Nlc3NmdWxseScsXG4gICAgICAgIHN0YXR1czogJ3N1Y2Nlc3MnLFxuICAgICAgICBkdXJhdGlvbjogMzAwMCxcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSBjYXRjaCAoZXJyOiB1bmtub3duKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBpc3N1aW5nIGNlcnRpZmljYXRlOicsIGVycik7XG4gICAgICB0b2FzdCh7XG4gICAgICAgIHRpdGxlOiAnRXJyb3IgaXNzdWluZyBjZXJ0aWZpY2F0ZScsXG4gICAgICAgIGRlc2NyaXB0aW9uOiBlcnIgaW5zdGFuY2VvZiBFcnJvciA/IGVyci5tZXNzYWdlIDogJ0FuIHVua25vd24gZXJyb3Igb2NjdXJyZWQnLFxuICAgICAgICBzdGF0dXM6ICdlcnJvcicsXG4gICAgICAgIGR1cmF0aW9uOiAzMDAwLFxuICAgICAgfSk7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfSBmaW5hbGx5IHtcbiAgICAgIHNldElzTG9hZGluZyhmYWxzZSk7XG4gICAgfVxuICB9O1xuXG4gIGNvbnN0IHNhdmVJbnN0aXR1dGlvblByb2ZpbGUgPSBhc3luYyAoZGF0YTogSW5zdGl0dXRpb25EYXRhKTogUHJvbWlzZTx2b2lkPiA9PiB7XG4gICAgaWYgKCFleGFtTWFuYWdlbWVudENvbnRyYWN0IHx8ICFhZGRyZXNzKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0NvbnRyYWN0IG9yIGFkZHJlc3Mgbm90IGF2YWlsYWJsZScpO1xuICAgIH1cblxuICAgIC8vIFZhbGlkYXRlIHJlcXVpcmVkIGZpZWxkc1xuICAgIGlmICghZGF0YS5uYW1lIHx8ICFkYXRhLm1pbmlzdHJ5IHx8ICFkYXRhLnVuaXZlcnNpdHkgfHwgIWRhdGEuY29sbGVnZSB8fCBcbiAgICAgICAgIWRhdGEuZGVzY3JpcHRpb24gfHwgIWRhdGEuaW1hZ2VVcmwgfHwgIWRhdGEud2Vic2l0ZSB8fCAhZGF0YS5lbWFpbCB8fCAhZGF0YS5waG9uZSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCfYrNmF2YrYuSDYp9mE2K3ZgtmI2YQg2YXYt9mE2YjYqNipIHwgQWxsIGZpZWxkcyBhcmUgcmVxdWlyZWQnKTtcbiAgICB9XG5cbiAgICB0cnkge1xuICAgICAgc2V0SXNMb2FkaW5nKHRydWUpO1xuICAgICAgY29uc3QgdHggPSBhd2FpdCBleGFtTWFuYWdlbWVudENvbnRyYWN0LndyaXRlLnVwZGF0ZUluc3RpdHV0aW9uUHJvZmlsZSh7XG4gICAgICAgIGFyZ3M6IFtcbiAgICAgICAgICBkYXRhLm5hbWUsXG4gICAgICAgICAgZGF0YS5taW5pc3RyeSxcbiAgICAgICAgICBkYXRhLnVuaXZlcnNpdHksXG4gICAgICAgICAgZGF0YS5jb2xsZWdlLFxuICAgICAgICAgIGRhdGEuZGVzY3JpcHRpb24sXG4gICAgICAgICAgZGF0YS5pbWFnZVVybCB8fCAnJyxcbiAgICAgICAgICBkYXRhLndlYnNpdGUgfHwgJycsXG4gICAgICAgICAgZGF0YS5lbWFpbCB8fCAnJyxcbiAgICAgICAgICBkYXRhLnBob25lIHx8ICcnXG4gICAgICAgIF1cbiAgICAgIH0pO1xuICAgICAgYXdhaXQgdHgud2FpdCgpO1xuICAgICAgc2V0SW5zdGl0dXRpb24oZGF0YSk7XG4gICAgICB0b2FzdCh7XG4gICAgICAgIHRpdGxlOiAn2KrZhSDYp9mE2K3Zgdi4INio2YbYrNin2K0gfCBTYXZlZCBTdWNjZXNzZnVsbHknLFxuICAgICAgICBzdGF0dXM6ICdzdWNjZXNzJyxcbiAgICAgICAgZHVyYXRpb246IDMwMDAsXG4gICAgICAgIGlzQ2xvc2FibGU6IHRydWUsXG4gICAgICB9KTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignRXJyb3Igc2F2aW5nIGluc3RpdHV0aW9uIHByb2ZpbGU6JywgZXJyb3IpO1xuICAgICAgdG9hc3Qoe1xuICAgICAgICB0aXRsZTogJ9iu2LfYoyDZgdmKINin2YTYrdmB2LggfCBFcnJvciBTYXZpbmcnLFxuICAgICAgICBkZXNjcmlwdGlvbjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnQW4gdW5rbm93biBlcnJvciBvY2N1cnJlZCcsXG4gICAgICAgIHN0YXR1czogJ2Vycm9yJyxcbiAgICAgICAgZHVyYXRpb246IDUwMDAsXG4gICAgICAgIGlzQ2xvc2FibGU6IHRydWUsXG4gICAgICB9KTtcbiAgICAgIHRocm93IGVycm9yO1xuICAgIH0gZmluYWxseSB7XG4gICAgICBzZXRJc0xvYWRpbmcoZmFsc2UpO1xuICAgIH1cbiAgfTtcblxuICByZXR1cm4ge1xuICAgIGluc3RpdHV0aW9uLFxuICAgIGV4YW1zLFxuICAgIGNlcnRpZmljYXRlcyxcbiAgICBpc0xvYWRpbmcsXG4gICAgaXNJbml0aWFsaXplZCxcbiAgICBoYXNBY2Nlc3MsXG4gICAgc2VsZWN0ZWRFeGFtUmVzdWx0cyxcbiAgICBleGFtU3RhdGlzdGljcyxcbiAgICBzYXZlSW5zdGl0dXRpb25Qcm9maWxlLFxuICAgIGNyZWF0ZUV4YW0sXG4gICAgdXBkYXRlRXhhbVN0YXR1cyxcbiAgICByZWdpc3RlclN0dWRlbnRzLFxuICAgIGhhbmRsZVN1Ym1pdFJlc3VsdHMsXG4gICAgaGFuZGxlRW5yb2xsU3R1ZGVudCxcbiAgICBsb2FkRXhhbVJlc3VsdHMsXG4gICAgaXNzdWVDZXJ0aWZpY2F0ZSxcbiAgfTtcbn07ICJdLCJuYW1lcyI6WyJ1c2VTdGF0ZSIsInVzZUVmZmVjdCIsInVzZVRvYXN0IiwiZ2V0RXhhbVJlc3VsdCIsImVucm9sbFN0dWRlbnQiLCJnZXRDb250cmFjdCIsInVzZUFjY291bnQiLCJ1c2VDb250cmFjdCIsIklOU1RJVFVUSU9OX1NUT1JBR0VfS0VZIiwiRVhBTVNfU1RPUkFHRV9LRVkiLCJDRVJUSUZJQ0FURVNfU1RPUkFHRV9LRVkiLCJ1c2VJbnN0aXR1dGlvbiIsImV4YW1NYW5hZ2VtZW50Q29udHJhY3QiLCJjZXJ0aWZpY2F0ZXNDb250cmFjdCIsImlzSW5pdGlhbGl6ZWQiLCJjb250cmFjdHNJbml0aWFsaXplZCIsImlzTG9hZGluZyIsImNvbnRyYWN0c0xvYWRpbmciLCJhZGRyZXNzIiwidW5kZWZpbmVkIiwiaXNDb25uZWN0ZWQiLCJ0b2FzdCIsInNldElzTG9hZGluZyIsInNldElzSW5pdGlhbGl6ZWQiLCJpbml0aWFsaXphdGlvbkF0dGVtcHRzIiwic2V0SW5pdGlhbGl6YXRpb25BdHRlbXB0cyIsImluc3RpdHV0aW9uIiwic2V0SW5zdGl0dXRpb24iLCJleGFtcyIsInNldEV4YW1zIiwiY2VydGlmaWNhdGVzIiwic2V0Q2VydGlmaWNhdGVzIiwiaGFzQWNjZXNzIiwic2V0SGFzQWNjZXNzIiwic2VsZWN0ZWRFeGFtUmVzdWx0cyIsInNldFNlbGVjdGVkRXhhbVJlc3VsdHMiLCJleGFtU3RhdGlzdGljcyIsInNldEV4YW1TdGF0aXN0aWNzIiwiY2hlY2tBY2Nlc3MiLCJ1c2VyQWRkcmVzcyIsImNvbnNvbGUiLCJsb2ciLCJlcnJvciIsInRpdGxlIiwiZGVzY3JpcHRpb24iLCJzdGF0dXMiLCJpc0luc3RpdHV0aW9uUmVzdWx0IiwiaXNJbnN0aXR1dGlvbiIsImluc3RpdHV0aW9uRGF0YSIsImdldEluc3RpdHV0aW9uIiwibGVuZ3RoIiwiaXNWZXJpZmllZCIsIkJvb2xlYW4iLCJpc01vdW50ZWQiLCJpbml0VGltZW91dCIsImluaXRpYWxpemVEYXRhIiwiaGFzQWRkcmVzcyIsImhhc0NvbnRyYWN0IiwiYXR0ZW1wdHMiLCJzZXRUaW1lb3V0IiwicHJldiIsImR1cmF0aW9uIiwiaXNDbG9zYWJsZSIsImFjY2Vzc0dyYW50ZWQiLCJleGFtc0RhdGEiLCJjZXJ0aWZpY2F0ZXNEYXRhIiwiUHJvbWlzZSIsImFsbCIsImxvYWRJbnN0aXR1dGlvbkZyb21Db250cmFjdCIsImxvYWRFeGFtc0Zyb21Db250cmFjdCIsImxvYWRDZXJ0aWZpY2F0ZXNGcm9tQ29udHJhY3QiLCJFcnJvciIsIm5hbWUiLCJtZXNzYWdlIiwic3RhY2siLCJjb250cmFjdFN0YXR1cyIsImhhc0V4YW1Db250cmFjdCIsImhhc0NlcnRpZmljYXRlc0NvbnRyYWN0IiwiY2xlYXJUaW1lb3V0IiwiZGF0YSIsIm1pbmlzdHJ5IiwidW5pdmVyc2l0eSIsImNvbGxlZ2UiLCJpbWFnZVVybCIsIndlYnNpdGUiLCJlbWFpbCIsInBob25lIiwiZ2V0SW5zdGl0dXRpb25FeGFtcyIsImdldEluc3RpdHV0aW9uQ2VydGlmaWNhdGVzIiwiY3JlYXRlRXhhbSIsImV4YW0iLCJjb250cmFjdCIsInR4IiwiZGF0ZSIsIndhaXQiLCJlcnIiLCJ1cGRhdGVFeGFtU3RhdHVzIiwiZXhhbUlkIiwicmVnaXN0ZXJTdHVkZW50cyIsInN0dWRlbnRzIiwiaGFuZGxlU3VibWl0UmVzdWx0cyIsInJlc3VsdHMiLCJzdWJtaXRSZXN1bHRzIiwibG9hZEV4YW1SZXN1bHRzIiwiY3VycmVudEV4YW0iLCJmaW5kIiwiaWQiLCJleGFtUmVzdWx0c0xpc3QiLCJtYXAiLCJzdHVkZW50SWQiLCJyZXN1bHQiLCJ2YWxpZFJlc3VsdHMiLCJmaWx0ZXIiLCJ0b3RhbFN0dWRlbnRzIiwicGFzc2luZ1N0dWRlbnRzIiwic2NvcmUiLCJ0b3RhbFNjb3JlIiwicmVkdWNlIiwic3VtIiwiZ3JhZGVDb3VudCIsIkEiLCJncmFkZSIsIkIiLCJDIiwiRCIsIkYiLCJtb3N0Q29tbW9uR3JhZGUiLCJPYmplY3QiLCJlbnRyaWVzIiwiYSIsImIiLCJwYXNzaW5nQ291bnQiLCJhQ291bnQiLCJiQ291bnQiLCJjQ291bnQiLCJkQ291bnQiLCJmQ291bnQiLCJhdmVyYWdlU2NvcmUiLCJwYXNzUmF0ZSIsImhhbmRsZUVucm9sbFN0dWRlbnQiLCJzdHVkZW50QWRkcmVzcyIsImlzc3VlQ2VydGlmaWNhdGUiLCJjZXJ0aWZpY2F0ZSIsInNhdmVJbnN0aXR1dGlvblByb2ZpbGUiLCJ3cml0ZSIsInVwZGF0ZUluc3RpdHV0aW9uUHJvZmlsZSIsImFyZ3MiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./hooks/useInstitution.ts\n"));

/***/ })

});